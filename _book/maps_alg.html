<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Functional Programming and Linear Algebra | Lancaster University MATH245 Computational Mathematics</title>
  <meta name="description" content="4 Functional Programming and Linear Algebra | Lancaster University MATH245 Computational Mathematics" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Functional Programming and Linear Algebra | Lancaster University MATH245 Computational Mathematics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Functional Programming and Linear Algebra | Lancaster University MATH245 Computational Mathematics" />
  
  
  

<meta name="author" content="Lecturers: Dr Eduard Campillo-Funollet and Dr Gaetano Romano" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="func_loop.html"/>
<link rel="next" href="df_plt.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro_prog.html"><a href="intro_prog.html"><i class="fa fa-check"></i><b>1</b> Introduction to Computational Mathematics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro_prog.html"><a href="intro_prog.html#what-is-a-computer"><i class="fa fa-check"></i><b>1.1</b> What is a Computer?</a></li>
<li class="chapter" data-level="1.2" data-path="intro_prog.html"><a href="intro_prog.html#computing-accessing-memory-and-storing"><i class="fa fa-check"></i><b>1.2</b> Computing, Accessing Memory and Storing</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="log_vec.html"><a href="log_vec.html"><i class="fa fa-check"></i><b>2</b> Logic and Vectors</a>
<ul>
<li class="chapter" data-level="2.1" data-path="log_vec.html"><a href="log_vec.html#comparisons"><i class="fa fa-check"></i><b>2.1</b> Comparisons</a></li>
<li class="chapter" data-level="2.2" data-path="log_vec.html"><a href="log_vec.html#logical-arithmetic"><i class="fa fa-check"></i><b>2.2</b> Logical Arithmetic</a></li>
<li class="chapter" data-level="2.3" data-path="log_vec.html"><a href="log_vec.html#flow"><i class="fa fa-check"></i><b>2.3</b> Flow</a></li>
<li class="chapter" data-level="2.4" data-path="log_vec.html"><a href="log_vec.html#vectors"><i class="fa fa-check"></i><b>2.4</b> Vectors</a></li>
<li class="chapter" data-level="2.5" data-path="log_vec.html"><a href="log_vec.html#accessing-vectors"><i class="fa fa-check"></i><b>2.5</b> Accessing vectors</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="func_loop.html"><a href="func_loop.html"><i class="fa fa-check"></i><b>3</b> Functions and Loops</a>
<ul>
<li class="chapter" data-level="3.1" data-path="func_loop.html"><a href="func_loop.html#functions"><i class="fa fa-check"></i><b>3.1</b> Functions</a></li>
<li class="chapter" data-level="3.2" data-path="func_loop.html"><a href="func_loop.html#looping"><i class="fa fa-check"></i><b>3.2</b> State and For Loop</a></li>
<li class="chapter" data-level="3.3" data-path="func_loop.html"><a href="func_loop.html#more-about-looping"><i class="fa fa-check"></i><b>3.3</b> More about looping</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="maps_alg.html"><a href="maps_alg.html"><i class="fa fa-check"></i><b>4</b> Functional Programming and Linear Algebra</a>
<ul>
<li class="chapter" data-level="4.1" data-path="maps_alg.html"><a href="maps_alg.html#Maps"><i class="fa fa-check"></i><b>4.1</b> An intro to Functional Programming</a></li>
<li class="chapter" data-level="4.2" data-path="maps_alg.html"><a href="maps_alg.html#doing-linear-algebra"><i class="fa fa-check"></i><b>4.2</b> Doing Linear Algebra</a></li>
<li class="chapter" data-level="4.3" data-path="maps_alg.html"><a href="maps_alg.html#an-end-note-to-this-chapter"><i class="fa fa-check"></i><b>4.3</b> An end note to this chapter</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="df_plt.html"><a href="df_plt.html"><i class="fa fa-check"></i><b>5</b> Data Frames and Plotting</a>
<ul>
<li class="chapter" data-level="5.1" data-path="df_plt.html"><a href="df_plt.html#data-frames"><i class="fa fa-check"></i><b>5.1</b> Data Frames</a></li>
<li class="chapter" data-level="5.2" data-path="df_plt.html"><a href="df_plt.html#plotting-with-ggplot-and-plotnine"><i class="fa fa-check"></i><b>5.2</b> Plotting with ggplot (and plotnine)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="challenge.html"><a href="challenge.html"><i class="fa fa-check"></i><b>6</b> Additional Programming Challenges</a>
<ul>
<li class="chapter" data-level="6.1" data-path="challenge.html"><a href="challenge.html#part-1-scientific-computing"><i class="fa fa-check"></i><b>6.1</b> Part 1: Scientific Computing</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Lancaster University MATH245 Computational Mathematics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="maps_alg" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Functional Programming and Linear Algebra<a href="maps_alg.html#maps_alg" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="Maps" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> An intro to Functional Programming<a href="maps_alg.html#Maps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We have seen so far two concepts from past week on how to run functions over collections of objects (in our case vectors). From <a href="maps_alg.html#maps_alg">this section</a> we learned how to run a function on a vector, whilst last week, we learned how to implement <a href="func_loop.html#looping">looping</a>, with <code>for</code> or <code>while</code> cycle, changing things as you go. We learned, <em>most importantly</em>, that we should use the for cycle if and only if we have state. Well, this is not my personal opinion only, as a matter of fact, there’s a programming philosophy called <em>functional programming</em>. Hadley, in his Advanced R book (sources in the index), gives a beautiful definition that sums up the properties of <strong>a functional programming language</strong>:</p>
<ul>
<li><p>Functional languages have <em>first class functions</em>. This means that functions are the primary building blocks. In this style, you can do a lot with functions. For example, you can treat functions just like vectors: you can assign them to variables, store them in lists, pass them as arguments to other functions, create them inside functions, and even return them as the result of a function.</p></li>
<li><p>In functional languages functions are <em>pure</em>. This means that there two properties to follow:</p>
<ol style="list-style-type: decimal">
<li><p>The output of a function depends only on its inputs. This means if you call a function with the same inputs, you’ll always get the same output.</p></li>
<li><p>A function doesn’t change anything outside of it, like a <em>global</em> variable (from the global enviroment), or do something like writing to disk or displaying to the screen. These are called side-effects.</p></li>
</ol></li>
</ul>
<p>Funny enough, he quotes Stroustroup, the father of C++:</p>
<p><em>“To become significantly more reliable, code must become more transparent. In particular, nested conditions and loops must be viewed with great suspicion. Complicated control flows confuse programmers. Messy code often hides bugs.”</em></p>
<p>— Bjarne Stroustrup<br />
</p>
<div class="figure">
<img src="https://i.redd.it/x00fit1u9ol11.png" width="472" alt="" />
<p class="caption">The father of c++</p>
</div>
<p>In a way you have already written in a functional programming way from the beginning of this module, with the exception of the loops in the past chapter. However, in this chapter, we will be introducing a couple of more concepts that should get rid of for cycles for most of the times!</p>
<div id="lambda-functions-and-function-factories" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Lambda Functions and Function Factories<a href="maps_alg.html#lambda-functions-and-function-factories" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A lambda function, also known as an anonymous function, is a function that is defined without a name, e.g. a function assigned to a variable. Lambda functions can have any number of arguments but <strong>only one expression</strong>, which is immediately evaluated and returned.</p>
<ul>
<li><strong>In R</strong>, we assign functions to variables by default (one of the reasons I prefer it as a language). Hence the only difference between a function and a lambda function (as you will see), is that a lambda function is only one expression long, so we don’t need to use the brackets <code>{}</code>. <strong>Recently from version 4.1</strong>, the lambda notation has been replaced by the <code>\</code> keyword, e.g. <code>function()</code> is equivalent to <code>\()</code>.</li>
<li><strong>In Python</strong> lambda functions are defined using the <code>lambda</code> keyword, whilst normal functions are defined using the <code>def</code> keyword. These will need to be one line long, and can be assigned to a variable.</li>
</ul>
<p>In both languages <strong>we can avoid the return statement</strong>, which makes them very easy and compact to write.</p>
<p>For example:</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 10px;">
<div>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="maps_alg.html#cb514-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a lambda function in R</span></span>
<span id="cb514-2"><a href="maps_alg.html#cb514-2" aria-hidden="true" tabindex="-1"></a>add_two_numbers <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) x <span class="sc">+</span> y</span>
<span id="cb514-3"><a href="maps_alg.html#cb514-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb514-4"><a href="maps_alg.html#cb514-4" aria-hidden="true" tabindex="-1"></a><span class="co"># equivalently, from R 4.1.0</span></span>
<span id="cb514-5"><a href="maps_alg.html#cb514-5" aria-hidden="true" tabindex="-1"></a>add_two_numbers <span class="ot">&lt;-</span> \(x, y) x <span class="sc">+</span> y</span>
<span id="cb514-6"><a href="maps_alg.html#cb514-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb514-7"><a href="maps_alg.html#cb514-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the lambda function</span></span>
<span id="cb514-8"><a href="maps_alg.html#cb514-8" aria-hidden="true" tabindex="-1"></a><span class="fu">add_two_numbers</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
</div>
<div>
<p><strong>Python</strong></p>
<div class="sourceCode" id="cb516"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb516-1"><a href="maps_alg.html#cb516-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a lambda function in Python</span></span>
<span id="cb516-2"><a href="maps_alg.html#cb516-2" aria-hidden="true" tabindex="-1"></a>add_two_numbers <span class="op">=</span> <span class="kw">lambda</span> x, y: x <span class="op">+</span> y</span>
<span id="cb516-3"><a href="maps_alg.html#cb516-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the lambda function</span></span>
<span id="cb516-4"><a href="maps_alg.html#cb516-4" aria-hidden="true" tabindex="-1"></a>add_two_numbers(<span class="dv">1</span>, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## 3</code></pre>
</div>
</div>
<p>In the above examples, we’ve defined a lambda function <code>add_two_numbers</code> in both R and Python that takes two arguments <code>x</code> and <code>y</code>, and returns their sum. When we call this function with <code>1</code> and <code>2</code>, as we would expect from any regular function, it returns <code>3</code>.</p>
<p>Now the cool stuff, as mentioned above, is that you can have a function that takes a number (or vector) as an input and return a function as output. This is often referred to as a <strong>function factory</strong>. To do so, we have to define functions inside functions, and then return those newly defined functions. Well, lambda functions, being compact, are the perfect candidate for this task.</p>
<p>Here is an example:</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 10px;">
<div>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="maps_alg.html#cb518-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function factory in R</span></span>
<span id="cb518-2"><a href="maps_alg.html#cb518-2" aria-hidden="true" tabindex="-1"></a>make_power <span class="ot">&lt;-</span> <span class="cf">function</span>(exponent) {</span>
<span id="cb518-3"><a href="maps_alg.html#cb518-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lambda here</span></span>
<span id="cb518-4"><a href="maps_alg.html#cb518-4" aria-hidden="true" tabindex="-1"></a>  pow <span class="ot">&lt;-</span> \(x) x<span class="sc">^</span>exponent</span>
<span id="cb518-5"><a href="maps_alg.html#cb518-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(pow)</span>
<span id="cb518-6"><a href="maps_alg.html#cb518-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb518-7"><a href="maps_alg.html#cb518-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the function factory</span></span>
<span id="cb518-8"><a href="maps_alg.html#cb518-8" aria-hidden="true" tabindex="-1"></a>cube <span class="ot">&lt;-</span> <span class="fu">make_power</span>(<span class="dv">3</span>)</span>
<span id="cb518-9"><a href="maps_alg.html#cb518-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cube</span>(<span class="dv">2</span>)  <span class="co"># Outputs 8</span></span></code></pre></div>
<pre><code>## [1] 8</code></pre>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="maps_alg.html#cb520-1" aria-hidden="true" tabindex="-1"></a>to_the_tenth <span class="ot">&lt;-</span> <span class="fu">make_power</span>(<span class="dv">10</span>)</span>
<span id="cb520-2"><a href="maps_alg.html#cb520-2" aria-hidden="true" tabindex="-1"></a><span class="fu">to_the_tenth</span>(<span class="dv">2</span>) <span class="co"># Outputs 1024</span></span></code></pre></div>
<pre><code>## [1] 1024</code></pre>
</div>
<div>
<p><strong>Python</strong></p>
<div class="sourceCode" id="cb522"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb522-1"><a href="maps_alg.html#cb522-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function factory in Python</span></span>
<span id="cb522-2"><a href="maps_alg.html#cb522-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> make_power(exponent):</span>
<span id="cb522-3"><a href="maps_alg.html#cb522-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lambda here</span></span>
<span id="cb522-4"><a href="maps_alg.html#cb522-4" aria-hidden="true" tabindex="-1"></a>  <span class="bu">pow</span> <span class="op">=</span> <span class="kw">lambda</span> x: x <span class="op">**</span> exponent</span>
<span id="cb522-5"><a href="maps_alg.html#cb522-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">pow</span></span>
<span id="cb522-6"><a href="maps_alg.html#cb522-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the function factory</span></span>
<span id="cb522-7"><a href="maps_alg.html#cb522-7" aria-hidden="true" tabindex="-1"></a>cube <span class="op">=</span> make_power(<span class="dv">3</span>)</span>
<span id="cb522-8"><a href="maps_alg.html#cb522-8" aria-hidden="true" tabindex="-1"></a>cube(<span class="dv">2</span>)  <span class="co"># Outputs 8</span></span></code></pre></div>
<pre><code>## 8</code></pre>
<div class="sourceCode" id="cb524"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb524-1"><a href="maps_alg.html#cb524-1" aria-hidden="true" tabindex="-1"></a>to_the_tenth <span class="op">=</span> make_power(<span class="dv">10</span>)</span>
<span id="cb524-2"><a href="maps_alg.html#cb524-2" aria-hidden="true" tabindex="-1"></a>to_the_tenth(<span class="dv">2</span>) <span class="co"># Outputs 1024</span></span></code></pre></div>
<pre><code>## 1024</code></pre>
</div>
</div>
<p>In the above examples, we’ve defined a function factory <code>make_power</code> in both R and Python that takes a number <code>exponent</code> as input (the exponent of our exponentiation function we want to built) and returns a function <code>pow</code> that raises its input <code>x</code> to the power of <code>exponent</code>. When we call this function factory with the argument <code>3</code>, it returns a function <code>cube</code> that cubes its input. When we call this <code>cube</code> function with the argument <code>2</code>, it returns <code>8</code>. Similarly, we create a function <code>to_the_tenth</code> that returns a function capable of doing the power of 10 of an input number.</p>
<p>This technique, sometimes referred as <em>currying</em>, is often used in functional programming to transform a function that takes multiple arguments into a series of functions that each take a single argument. It works with existing functions as well, and can be extremely useful in many situations, in particular when you have many arguments and you’re only interested in changing one. Let’s give a longer example.</p>
<p>Let’s have a look at this weird function:</p>
<p><span class="math display">\[
f(x) = x^2 + x *  \sin(x + 1.5 x^2)
\]</span></p>
<p><img src="images/unnamed-chunk-151-1.png" width="50%" /></p>
<p>Say we want to study numerically its local maxima. With currying, this can be done in a neat and elegant fashion:</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 10px;">
<div>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="maps_alg.html#cb526-1" aria-hidden="true" tabindex="-1"></a><span class="co"># overloading the arguments of seq to return </span></span>
<span id="cb526-2"><a href="maps_alg.html#cb526-2" aria-hidden="true" tabindex="-1"></a><span class="co"># a lambda that takes an upper argument</span></span>
<span id="cb526-3"><a href="maps_alg.html#cb526-3" aria-hidden="true" tabindex="-1"></a>grid_factory <span class="ot">&lt;-</span> <span class="cf">function</span>(len) {</span>
<span id="cb526-4"><a href="maps_alg.html#cb526-4" aria-hidden="true" tabindex="-1"></a>  make_grid <span class="ot">&lt;-</span> \(up) <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span>up, <span class="at">length.out =</span> len)</span>
<span id="cb526-5"><a href="maps_alg.html#cb526-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(make_grid)</span>
<span id="cb526-6"><a href="maps_alg.html#cb526-6" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb526-7"><a href="maps_alg.html#cb526-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-8"><a href="maps_alg.html#cb526-8" aria-hidden="true" tabindex="-1"></a><span class="co"># our function</span></span>
<span id="cb526-9"><a href="maps_alg.html#cb526-9" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> \(x) x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> x <span class="sc">*</span>  <span class="fu">sin</span>(x <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb526-10"><a href="maps_alg.html#cb526-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-11"><a href="maps_alg.html#cb526-11" aria-hidden="true" tabindex="-1"></a><span class="do">### low resolution grid maker</span></span>
<span id="cb526-12"><a href="maps_alg.html#cb526-12" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">grid_factory</span>(<span class="dv">10</span>)</span>
<span id="cb526-13"><a href="maps_alg.html#cb526-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-14"><a href="maps_alg.html#cb526-14" aria-hidden="true" tabindex="-1"></a><span class="co"># max up to 2.5 (low res)</span></span>
<span id="cb526-15"><a href="maps_alg.html#cb526-15" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">f</span>(<span class="fu">g1</span>(<span class="fl">2.5</span>))</span>
<span id="cb526-16"><a href="maps_alg.html#cb526-16" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(y)</span></code></pre></div>
<pre><code>## [1] 6.916713</code></pre>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="maps_alg.html#cb528-1" aria-hidden="true" tabindex="-1"></a><span class="co"># max up to 3.5 (low res)</span></span>
<span id="cb528-2"><a href="maps_alg.html#cb528-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">f</span>(<span class="fu">g1</span>(<span class="fl">3.5</span>))</span>
<span id="cb528-3"><a href="maps_alg.html#cb528-3" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(y)</span></code></pre></div>
<pre><code>## [1] 12.53</code></pre>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="maps_alg.html#cb530-1" aria-hidden="true" tabindex="-1"></a><span class="do">### high resolution grid maker</span></span>
<span id="cb530-2"><a href="maps_alg.html#cb530-2" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">grid_factory</span>(<span class="dv">1000</span>)</span>
<span id="cb530-3"><a href="maps_alg.html#cb530-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb530-4"><a href="maps_alg.html#cb530-4" aria-hidden="true" tabindex="-1"></a><span class="co"># max up to 2.5 (high res)</span></span>
<span id="cb530-5"><a href="maps_alg.html#cb530-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">f</span>(<span class="fu">g2</span>(<span class="fl">2.5</span>))</span>
<span id="cb530-6"><a href="maps_alg.html#cb530-6" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(y)</span></code></pre></div>
<pre><code>## [1] 6.91784</code></pre>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="maps_alg.html#cb532-1" aria-hidden="true" tabindex="-1"></a><span class="co"># max up to 3.5 (high res)</span></span>
<span id="cb532-2"><a href="maps_alg.html#cb532-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">f</span>(<span class="fu">g2</span>(<span class="fl">3.5</span>))</span>
<span id="cb532-3"><a href="maps_alg.html#cb532-3" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(y)</span></code></pre></div>
<pre><code>## [1] 12.55501</code></pre>
</div>
<div>
<p><strong>Python</strong></p>
<div class="sourceCode" id="cb534"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb534-1"><a href="maps_alg.html#cb534-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb534-2"><a href="maps_alg.html#cb534-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-3"><a href="maps_alg.html#cb534-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> grid_factory(<span class="bu">len</span>):</span>
<span id="cb534-4"><a href="maps_alg.html#cb534-4" aria-hidden="true" tabindex="-1"></a>    make_grid <span class="op">=</span> <span class="kw">lambda</span> up: np.linspace(<span class="dv">0</span>, up, <span class="bu">len</span>)</span>
<span id="cb534-5"><a href="maps_alg.html#cb534-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> make_grid</span>
<span id="cb534-6"><a href="maps_alg.html#cb534-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-7"><a href="maps_alg.html#cb534-7" aria-hidden="true" tabindex="-1"></a><span class="co"># our function</span></span>
<span id="cb534-8"><a href="maps_alg.html#cb534-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb534-9"><a href="maps_alg.html#cb534-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> x <span class="op">*</span> np.sin(x <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> x<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb534-10"><a href="maps_alg.html#cb534-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-11"><a href="maps_alg.html#cb534-11" aria-hidden="true" tabindex="-1"></a><span class="co">### low resolution grid maker</span></span>
<span id="cb534-12"><a href="maps_alg.html#cb534-12" aria-hidden="true" tabindex="-1"></a>g1 <span class="op">=</span> grid_factory(<span class="dv">10</span>)</span>
<span id="cb534-13"><a href="maps_alg.html#cb534-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-14"><a href="maps_alg.html#cb534-14" aria-hidden="true" tabindex="-1"></a><span class="co"># max up to 2.5 (low res)</span></span>
<span id="cb534-15"><a href="maps_alg.html#cb534-15" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> f(g1(<span class="fl">2.5</span>))</span>
<span id="cb534-16"><a href="maps_alg.html#cb534-16" aria-hidden="true" tabindex="-1"></a>y.<span class="bu">max</span>()</span></code></pre></div>
<pre><code>## 6.916712586188865</code></pre>
<div class="sourceCode" id="cb536"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb536-1"><a href="maps_alg.html#cb536-1" aria-hidden="true" tabindex="-1"></a><span class="co"># max up to 3.5 (low res)</span></span>
<span id="cb536-2"><a href="maps_alg.html#cb536-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> f(g1(<span class="fl">3.5</span>))</span>
<span id="cb536-3"><a href="maps_alg.html#cb536-3" aria-hidden="true" tabindex="-1"></a>y.<span class="bu">max</span>()</span></code></pre></div>
<pre><code>## 12.529999050349009</code></pre>
<div class="sourceCode" id="cb538"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb538-1"><a href="maps_alg.html#cb538-1" aria-hidden="true" tabindex="-1"></a><span class="co">### high resolution grid maker</span></span>
<span id="cb538-2"><a href="maps_alg.html#cb538-2" aria-hidden="true" tabindex="-1"></a>g2 <span class="op">=</span> grid_factory(<span class="dv">1000</span>)</span>
<span id="cb538-3"><a href="maps_alg.html#cb538-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-4"><a href="maps_alg.html#cb538-4" aria-hidden="true" tabindex="-1"></a><span class="co"># max up to 2.5 (high res)</span></span>
<span id="cb538-5"><a href="maps_alg.html#cb538-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> f(g2(<span class="fl">2.5</span>))</span>
<span id="cb538-6"><a href="maps_alg.html#cb538-6" aria-hidden="true" tabindex="-1"></a>y.<span class="bu">max</span>()</span></code></pre></div>
<pre><code>## 6.917839669205563</code></pre>
<div class="sourceCode" id="cb540"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb540-1"><a href="maps_alg.html#cb540-1" aria-hidden="true" tabindex="-1"></a><span class="co"># max up to 3.5 (high res)</span></span>
<span id="cb540-2"><a href="maps_alg.html#cb540-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> f(g2(<span class="fl">3.5</span>))</span>
<span id="cb540-3"><a href="maps_alg.html#cb540-3" aria-hidden="true" tabindex="-1"></a>y.<span class="bu">max</span>()</span></code></pre></div>
<pre><code>## 12.555009403226697</code></pre>
</div>
</div>
<p>In this example, we define a <code>grid_factory</code> function that takes a single argument <code>len</code> and returns a lambda function that takes an upper argument up. The lambda function generates a sequence of numbers between 0 and up with a specified length <code>len</code>.</p>
<p>We then define our function <code>f</code> to evaluate our expression <span class="math inline">\(x^2 + x * sin(x - 1.5 * x^2)\)</span>.</p>
<p>We use the <code>grid_factory</code> function to create two functions to compute grids of different resolutions, <code>g1</code> and <code>g2</code>, and use these grids to compute the maximum value of <code>f(x)</code> for different values of <code>x</code>.</p>
<div id="fizzbuzz-v10299384" class="section level4 hasAnchor" number="4.1.1.1">
<h4><span class="header-section-number">4.1.1.1</span> Fizzbuzz v10299384<a href="maps_alg.html#fizzbuzz-v10299384" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We’re about to create a weird overly-engineered version of FizzBuzz: <code>fizzbuzz_v10299384</code> (the vector solution we had in Chapter 2 was pretty elegant already, so use that in coding interviews). What will follow is an example <em>for you to break</em> to illustrate the possibilities of functional programming.</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 10px;">
<div>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="maps_alg.html#cb542-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A lambda that prints a message </span></span>
<span id="cb542-2"><a href="maps_alg.html#cb542-2" aria-hidden="true" tabindex="-1"></a><span class="co"># given a remainder</span></span>
<span id="cb542-3"><a href="maps_alg.html#cb542-3" aria-hidden="true" tabindex="-1"></a>remainder_printer <span class="ot">&lt;-</span> \(p, q, message)</span>
<span id="cb542-4"><a href="maps_alg.html#cb542-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (p <span class="sc">%%</span> q <span class="sc">==</span> <span class="dv">0</span>) message <span class="cf">else</span> <span class="st">&quot;&quot;</span></span>
<span id="cb542-5"><a href="maps_alg.html#cb542-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb542-6"><a href="maps_alg.html#cb542-6" aria-hidden="true" tabindex="-1"></a>fizzbuzz_v10299384 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb542-7"><a href="maps_alg.html#cb542-7" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> \(printer)</span>
<span id="cb542-8"><a href="maps_alg.html#cb542-8" aria-hidden="true" tabindex="-1"></a>    \(x) <span class="fu">paste0</span>(<span class="fu">printer</span>(x, <span class="dv">3</span>, <span class="st">&quot;fizz&quot;</span>), <span class="fu">printer</span>(x, <span class="dv">5</span>, <span class="st">&quot;buzz&quot;</span>))</span>
<span id="cb542-9"><a href="maps_alg.html#cb542-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb542-10"><a href="maps_alg.html#cb542-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># creating a new function and calling it directly!</span></span>
<span id="cb542-11"><a href="maps_alg.html#cb542-11" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">f</span>(remainder_printer)(x)</span>
<span id="cb542-12"><a href="maps_alg.html#cb542-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb542-13"><a href="maps_alg.html#cb542-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nchar</span>(out) <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb542-14"><a href="maps_alg.html#cb542-14" aria-hidden="true" tabindex="-1"></a>    out <span class="ot">&lt;-</span> x </span>
<span id="cb542-15"><a href="maps_alg.html#cb542-15" aria-hidden="true" tabindex="-1"></a>  out</span>
<span id="cb542-16"><a href="maps_alg.html#cb542-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb542-17"><a href="maps_alg.html#cb542-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb542-18"><a href="maps_alg.html#cb542-18" aria-hidden="true" tabindex="-1"></a><span class="fu">fizzbuzz_v10299384</span>(<span class="dv">15</span>)</span></code></pre></div>
<pre><code>## [1] &quot;fizzbuzz&quot;</code></pre>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="maps_alg.html#cb544-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fizzbuzz_v10299384</span>(<span class="dv">7</span>)</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
</div>
<div>
<p><strong>Python</strong></p>
<div class="sourceCode" id="cb546"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb546-1"><a href="maps_alg.html#cb546-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A lambda that prints a message given a remainder</span></span>
<span id="cb546-2"><a href="maps_alg.html#cb546-2" aria-hidden="true" tabindex="-1"></a>remainder_printer <span class="op">=</span> <span class="kw">lambda</span> p, q, message: message <span class="cf">if</span> p <span class="op">%</span> q <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">&quot;&quot;</span></span>
<span id="cb546-3"><a href="maps_alg.html#cb546-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb546-4"><a href="maps_alg.html#cb546-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fizzbuzz_v10299384(x):</span>
<span id="cb546-5"><a href="maps_alg.html#cb546-5" aria-hidden="true" tabindex="-1"></a>    f <span class="op">=</span> <span class="kw">lambda</span> printer: <span class="kw">lambda</span> x: printer(x, <span class="dv">3</span>, <span class="st">&quot;fizz&quot;</span>) <span class="op">+</span> printer(x, <span class="dv">5</span>, <span class="st">&quot;buzz&quot;</span>)</span>
<span id="cb546-6"><a href="maps_alg.html#cb546-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb546-7"><a href="maps_alg.html#cb546-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># creating a new function and calling it directly!</span></span>
<span id="cb546-8"><a href="maps_alg.html#cb546-8" aria-hidden="true" tabindex="-1"></a>    out <span class="op">=</span> f(remainder_printer)(x)</span>
<span id="cb546-9"><a href="maps_alg.html#cb546-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb546-10"><a href="maps_alg.html#cb546-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(out) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb546-11"><a href="maps_alg.html#cb546-11" aria-hidden="true" tabindex="-1"></a>        out <span class="op">=</span> <span class="bu">str</span>(x)</span>
<span id="cb546-12"><a href="maps_alg.html#cb546-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> out</span>
<span id="cb546-13"><a href="maps_alg.html#cb546-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb546-14"><a href="maps_alg.html#cb546-14" aria-hidden="true" tabindex="-1"></a>fizzbuzz_v10299384(<span class="dv">15</span>)</span></code></pre></div>
<pre><code>## &#39;fizzbuzz&#39;</code></pre>
<div class="sourceCode" id="cb548"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb548-1"><a href="maps_alg.html#cb548-1" aria-hidden="true" tabindex="-1"></a>fizzbuzz_v10299384(<span class="dv">7</span>)</span></code></pre></div>
<pre><code>## &#39;7&#39;</code></pre>
</div>
</div>
<p>What on earth is going on? Well, let’s try to break it down:</p>
<ul>
<li><code>remainder_printer</code> is a lambda function that takes three arguments: <code>p</code>, <code>q</code>, and <code>message</code>. It checks if <code>p</code> is divisible by <code>q</code> (i.e., <code>p</code> modulo <code>q</code> equals <code>0</code>), and if so, it returns <code>message</code>; otherwise, it returns an empty string.</li>
<li><code>fizzbuzz_v10299384</code> is a function that takes one argument: <code>x</code>, our number, and returns the FizzBuzz string.
<ul>
<li>It defines a lambda function <code>f</code> that takes one argument: <code>printer</code> (which is expected to be a function). It returns a new lambda function that takes one argument <code>x</code>, our number to check. Recall, that a function can take <em>another function</em> as input and return a new function by overloading its arguments.</li>
<li>The function returned by f, is another lambda: this returns the concatenation of the results of calling <code>printer</code> with <code>x</code>, <code>3</code>, and <code>"fizz"</code>, and with <code>x</code>, <code>5</code>, and <code>"buzz"</code>.</li>
<li>We we then call <code>f</code> with <code>remainder_printer</code> as the argument, this will return a lambda that, as described above, will concatenate the fizz and buzz strings. The first step is done with <code>f(remainder_printer)</code>. This new <strong>unnassigned</strong> function is then immediately called with <code>x</code> via <code>f(remainder_printer)(x)</code>.</li>
<li>If the result of this operation is an empty string, we return <code>x</code> instead. The condition on the length of the string is checked with <code>nchar</code> in R and <code>len</code> in Python.</li>
</ul></li>
</ul>
<p>This could have been shortened of at least a couple of statements (try it yourself!). But this should have showcased how many things we can do with functions. In the next exercise, we are going to use some of these concepts to build <em>the ultimate FizzBuzz program</em> (not underselling).</p>
<p>Before doing that, however, we need to introduce the <code>map</code> and <code>reduce</code> operations.</p>
</div>
</div>
<div id="the-map-operation" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> The map operation<a href="maps_alg.html#the-map-operation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>map</code> operation is a function that takes a function and a vector as input, and returns a vector. Each element of the output vector is the result of applying the input function to the corresponding element of the input vector:</p>
<p><img src="images/chapter4/map.png" /></p>
<p>This allows us to apply a function to each element of a vector without having to write a loop. We have already done this when running a function on a vector, however, as we are going to see in a moment, map is a much more general statement. In fact, there are many functions in R and python that are not <em>vectorized</em>, meaning they don’t naturally handle vector inputs. If you try to apply a non-vectorized function directly to a vector, you might get a bug or unexpected results.</p>
<p>Let’s consider a simple function that squares a number. We will apply this function to a vector of numbers using the <code>map</code> operation in both R and Python:</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 10px;">
<div>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="maps_alg.html#cb550-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import the purrr library</span></span>
<span id="cb550-2"><a href="maps_alg.html#cb550-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb550-3"><a href="maps_alg.html#cb550-3" aria-hidden="true" tabindex="-1"></a><span class="co"># this is how we import libraries in R!</span></span>
<span id="cb550-4"><a href="maps_alg.html#cb550-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-5"><a href="maps_alg.html#cb550-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function that squares a number using the factory above</span></span>
<span id="cb550-6"><a href="maps_alg.html#cb550-6" aria-hidden="true" tabindex="-1"></a>square <span class="ot">&lt;-</span> <span class="fu">make_power</span>(<span class="dv">2</span>)</span>
<span id="cb550-7"><a href="maps_alg.html#cb550-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-8"><a href="maps_alg.html#cb550-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a vector of numbers</span></span>
<span id="cb550-9"><a href="maps_alg.html#cb550-9" aria-hidden="true" tabindex="-1"></a>numbers <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb550-10"><a href="maps_alg.html#cb550-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-11"><a href="maps_alg.html#cb550-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the map function to apply the square function to the vector</span></span>
<span id="cb550-12"><a href="maps_alg.html#cb550-12" aria-hidden="true" tabindex="-1"></a>squares <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(numbers, square)</span>
<span id="cb550-13"><a href="maps_alg.html#cb550-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-14"><a href="maps_alg.html#cb550-14" aria-hidden="true" tabindex="-1"></a>squares</span></code></pre></div>
<pre><code>## [1]  1  4  9 16 25</code></pre>
</div>
<div>
<p><strong>Python</strong></p>
<div class="sourceCode" id="cb552"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb552-1"><a href="maps_alg.html#cb552-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function that squares a number</span></span>
<span id="cb552-2"><a href="maps_alg.html#cb552-2" aria-hidden="true" tabindex="-1"></a>square <span class="op">=</span> make_power(<span class="dv">2</span>)</span>
<span id="cb552-3"><a href="maps_alg.html#cb552-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb552-4"><a href="maps_alg.html#cb552-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a list of numbers</span></span>
<span id="cb552-5"><a href="maps_alg.html#cb552-5" aria-hidden="true" tabindex="-1"></a>numbers <span class="op">=</span> np.arange(<span class="dv">1</span>, <span class="dv">6</span>)</span>
<span id="cb552-6"><a href="maps_alg.html#cb552-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb552-7"><a href="maps_alg.html#cb552-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the map function to apply the square function to the list</span></span>
<span id="cb552-8"><a href="maps_alg.html#cb552-8" aria-hidden="true" tabindex="-1"></a>squares <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(square, numbers))</span>
<span id="cb552-9"><a href="maps_alg.html#cb552-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb552-10"><a href="maps_alg.html#cb552-10" aria-hidden="true" tabindex="-1"></a>squares</span></code></pre></div>
<pre><code>## [1, 4, 9, 16, 25]</code></pre>
</div>
</div>
<p>In the above examples, we’ve defined a function <code>square</code> that squares its input using the <code>make_power</code> function. We then created a vector (or list in Python) <code>numbers</code> with the numbers from <code>1</code> to <code>5</code>. We used the <code>map</code> function to apply <code>square</code> to each element of <code>numbers</code>, resulting in a new vector <code>squares</code> that contains the squares of the numbers.</p>
<p><strong>NOTE: For R Users</strong>: The <code>map</code> function is part of the <code>purrr</code> package, so you need to import it with <code>library(purrr)</code>; you can have this code at the start of the script. The <code>map</code> function in R takes as argument the vector first, and then the function. The <code>map</code> function in R returns a list by default. A list in R is similar to a vector, but unlike a vector, a list can contain elements of different types. This means a list can be a collection of numbers, vectors, matrices, characters, functions, potatoes, onions, parupzluplups and so on. The <code>map</code> function defaults to a list, as, <em>a priori</em>, does not know what the output of a function could be. If you want a vector as output, you should use the type-specific <code>map</code> functions like <code>map_lgl</code>, <code>map_int</code>, <code>map_dbl</code>, and <code>map_chr</code>. For this reason, above, we used the <code>map_dbl</code>, as we wanted a vector of double precision numbers. Try to swap the function <code>map_dbl</code> for <code>map_chr</code> and see what happens. Also, note that <code>map</code> is implemented natively in R using the <code>apply</code> family of functions, see <code>help(apply)</code> for more details. The code above would have been:</p>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="maps_alg.html#cb554-1" aria-hidden="true" tabindex="-1"></a>squares <span class="ot">=</span> <span class="fu">sapply</span>(numbers, square)</span></code></pre></div>
<p>Where now the function and the vector are swapped in the argument. Also, we are using <code>sapply</code> as this returns a vector, whilst the simple <code>apply</code> function returns a list.</p>
<p><strong>NOTE: For Python Users</strong>: The <code>map</code> function in Python takes as argument the function first, and then the vector. In Python, the map function returns a map object, which is an iterator that yields results on demand. This means that the map function doesn’t actually compute the results until you iterate over the map object. This can be very efficient for large inputs, as it allows the computation to be spread out over time. However, if you want to see all the results at once, you need to convert the map object to a list, which is what the list function does. So when you see <code>list(map(...))</code> in Python, it means “apply this function to each element of this iterable, and give me a list of the results right away”. The <code>map</code> operation in Python can also be achieved with list comprehensions, which provide a more “Pythonic” way to create lists based on existing lists. Here’s how you can rewrite the previous example using a list comprehension:</p>
<div class="sourceCode" id="cb555"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb555-1"><a href="maps_alg.html#cb555-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use a list comprehension to apply the square function to the list</span></span>
<span id="cb555-2"><a href="maps_alg.html#cb555-2" aria-hidden="true" tabindex="-1"></a>squares <span class="op">=</span> [square(x) <span class="cf">for</span> x <span class="kw">in</span> numbers]</span>
<span id="cb555-3"><a href="maps_alg.html#cb555-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb555-4"><a href="maps_alg.html#cb555-4" aria-hidden="true" tabindex="-1"></a>squares</span></code></pre></div>
<pre><code>## [1, 4, 9, 16, 25]</code></pre>
<p>In this example, <code>square(x) for x in numbers</code> is a list comprehension that applies <code>square</code> to each element of <code>numbers</code>. You can read it as: “Run square of x for every x in numbers”, which is very similar to writing in maths <span class="math inline">\(x^2 \ \text{for} \ x \in N\)</span>. The result is a new list <code>squares</code> that contains the squares of the numbers.</p>
<p><strong>Equivalent Shorter Statements</strong></p>
<p>Of course, the advantage is that you can write very compact code with maps, lambdas and function factories! So far, I have been expanding lines upon lines, to make sure that everything is clear, however you could have done the above tasks with a one liner:</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 10px;">
<div>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="maps_alg.html#cb557-1" aria-hidden="true" tabindex="-1"></a>squares <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="fu">make_power</span>(<span class="dv">2</span>))</span>
<span id="cb557-2"><a href="maps_alg.html#cb557-2" aria-hidden="true" tabindex="-1"></a>squares</span></code></pre></div>
<pre><code>## [1]  1  4  9 16 25</code></pre>
</div>
<div>
<p><strong>Python</strong></p>
<div class="sourceCode" id="cb559"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb559-1"><a href="maps_alg.html#cb559-1" aria-hidden="true" tabindex="-1"></a>squares <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(make_power(<span class="dv">2</span>), np.arange(<span class="dv">1</span>, <span class="dv">6</span>)))</span>
<span id="cb559-2"><a href="maps_alg.html#cb559-2" aria-hidden="true" tabindex="-1"></a>squares</span></code></pre></div>
<pre><code>## [1, 4, 9, 16, 25]</code></pre>
</div>
</div>
<div id="exercise-4" class="section level4 hasAnchor" number="4.1.2.1">
<h4><span class="header-section-number">4.1.2.1</span> Exercise<a href="maps_alg.html#exercise-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li>Create a vector of the first 15 natural numbers.</li>
<li>Run the <code>fizzbuzz_v10299384</code> function on the vector above and see what happens. It should work, right? No?</li>
<li>Now, run <code>fizzbuzz_v10299384</code> with map on the same vector, and see the result.</li>
<li>Lastly, research the two function factories <code>Vectorised</code> and <code>np.vectorise</code>, try to vectorise <code>fizzbuzz_v10299384</code> and run it as you did in point 1. Did you fix the issue?</li>
</ol>
</div>
<div id="map-2" class="section level4 hasAnchor" number="4.1.2.2">
<h4><span class="header-section-number">4.1.2.2</span> Map 2<a href="maps_alg.html#map-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There’s a lot of examples in cinema where the sequel is arguably better then the first one, like Shrek 2, Cars 2, Jaws 2, The second Star Wars trilogy, The Hangover 2, Bee Movie 2, Karate Kid 2… the list is endless!</p>
<p>Well, even in programming <code>map2</code> is better then <code>map</code>. You might be in fact wondering: what’s the point of having <code>map</code> when we already have vectorised functions? Well, <code>map2</code> is the answer. The <code>map2</code> operation is a function that takes two vectors and a function as input, and returns a vector. Each element of the output vector is the result of applying the input function to the corresponding elements of the input vectors. In a vectorized function, on the other hand, there’s no straightforward way of passing two arguments to a function.</p>
<p>Let’s consider a simple function that adds two numbers. We will apply this function to two vectors using the <code>map2</code> operation (in R) and the <code>map</code> operation (in Python it can take as many arguments as necessary by default):</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 10px;">
<div>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="maps_alg.html#cb561-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a lambda that adds two numbers</span></span>
<span id="cb561-2"><a href="maps_alg.html#cb561-2" aria-hidden="true" tabindex="-1"></a>add <span class="ot">&lt;-</span> \(x, y) x <span class="sc">+</span> y</span>
<span id="cb561-3"><a href="maps_alg.html#cb561-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-4"><a href="maps_alg.html#cb561-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create two vectors of numbers</span></span>
<span id="cb561-5"><a href="maps_alg.html#cb561-5" aria-hidden="true" tabindex="-1"></a>numbers1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb561-6"><a href="maps_alg.html#cb561-6" aria-hidden="true" tabindex="-1"></a>numbers2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>)</span>
<span id="cb561-7"><a href="maps_alg.html#cb561-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-8"><a href="maps_alg.html#cb561-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the map2 function to apply the add function to the vectors</span></span>
<span id="cb561-9"><a href="maps_alg.html#cb561-9" aria-hidden="true" tabindex="-1"></a>sums <span class="ot">&lt;-</span> <span class="fu">map2_dbl</span>(numbers1, numbers2, add)</span>
<span id="cb561-10"><a href="maps_alg.html#cb561-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-11"><a href="maps_alg.html#cb561-11" aria-hidden="true" tabindex="-1"></a>sums</span></code></pre></div>
<pre><code>## [1] 11 13 15</code></pre>
</div>
<div>
<p><strong>Python</strong></p>
<div class="sourceCode" id="cb563"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb563-1"><a href="maps_alg.html#cb563-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a lambda that adds two numbers</span></span>
<span id="cb563-2"><a href="maps_alg.html#cb563-2" aria-hidden="true" tabindex="-1"></a>add <span class="op">=</span> <span class="kw">lambda</span> x, y: x <span class="op">+</span> y</span>
<span id="cb563-3"><a href="maps_alg.html#cb563-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb563-4"><a href="maps_alg.html#cb563-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create two lists of numbers</span></span>
<span id="cb563-5"><a href="maps_alg.html#cb563-5" aria-hidden="true" tabindex="-1"></a>numbers1 <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb563-6"><a href="maps_alg.html#cb563-6" aria-hidden="true" tabindex="-1"></a>numbers2 <span class="op">=</span> [<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>]</span>
<span id="cb563-7"><a href="maps_alg.html#cb563-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb563-8"><a href="maps_alg.html#cb563-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the map function to apply the add function to the lists</span></span>
<span id="cb563-9"><a href="maps_alg.html#cb563-9" aria-hidden="true" tabindex="-1"></a>sums <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(add, numbers1, numbers2))</span>
<span id="cb563-10"><a href="maps_alg.html#cb563-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb563-11"><a href="maps_alg.html#cb563-11" aria-hidden="true" tabindex="-1"></a>sums</span></code></pre></div>
<pre><code>## [11, 13, 15]</code></pre>
</div>
</div>
<p>In the above examples, we’ve defined a function <code>add</code> that adds its two inputs. We then created two vectors (or lists in Python) <code>numbers1</code> and <code>numbers2</code>. We used the <code>map2</code>/<code>map</code> function to apply <code>add</code> to each pair of elements from <code>numbers1</code> and <code>numbers2</code>, resulting in a new vector <code>sums</code> that contains the sums of the numbers.</p>
<p><strong>Shorter statements</strong>. We can write the map2 statements above in a very compact way again:</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 10px;">
<div>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="maps_alg.html#cb565-1" aria-hidden="true" tabindex="-1"></a>sums <span class="ot">&lt;-</span> <span class="fu">map2_dbl</span>( <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),  <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>), \(x, y) x<span class="sc">+</span>y)</span>
<span id="cb565-2"><a href="maps_alg.html#cb565-2" aria-hidden="true" tabindex="-1"></a>sums</span></code></pre></div>
<pre><code>## [1] 11 13 15</code></pre>
</div>
<div>
<p><strong>Python</strong></p>
<div class="sourceCode" id="cb567"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb567-1"><a href="maps_alg.html#cb567-1" aria-hidden="true" tabindex="-1"></a>sums <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x, y: x <span class="op">+</span> y, [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>]))</span>
<span id="cb567-2"><a href="maps_alg.html#cb567-2" aria-hidden="true" tabindex="-1"></a>sums</span></code></pre></div>
<pre><code>## [11, 13, 15]</code></pre>
</div>
</div>
<p><strong>Note for Python Users</strong>: The <code>map</code> operation with two arguments can also be achieved in a more “Pythonic way” with list comprehensions. Here’s how you can rewrite the previous example:</p>
<div class="sourceCode" id="cb569"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb569-1"><a href="maps_alg.html#cb569-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use a list comprehension to apply the add function to the lists</span></span>
<span id="cb569-2"><a href="maps_alg.html#cb569-2" aria-hidden="true" tabindex="-1"></a>sums <span class="op">=</span> [add(x, y) <span class="cf">for</span> x, y <span class="kw">in</span> <span class="bu">zip</span>(numbers1, numbers2)]</span>
<span id="cb569-3"><a href="maps_alg.html#cb569-3" aria-hidden="true" tabindex="-1"></a>sums</span></code></pre></div>
<pre><code>## [11, 13, 15]</code></pre>
<p>In this example, the list comprehension statement relies on the <code>zip</code> function. <code>zip</code> is used to pair up the elements from <code>numbers1</code> and <code>numbers2</code>. Try to run <code>zip(numbers1, numbers2)</code> alone to see the output! I personally find that the <code>map</code> function is more readable, however you should be familiar with both ways as you will be encountering both if you keep programming with Python. One other advantage is that the <code>map</code> function is inherently flexible and can take as many arguments as necessary. This is because it’s designed to apply a function to multiple iterables in parallel. If you pass more than one iterable to <code>map</code>, it will pass corresponding elements from each iterable to the function. This allows you to easily apply a function to multiple arguments.</p>
<p><strong>Note for R Users</strong> <code>map2</code> is limited to two arguments, however in <code>purr</code>, we do have a <code>map</code> function that can take as many arguments as necessary: the <code>pmap</code> function. The <code>pmap</code> function has a slightly different notation, as it takes a list of vectors (or a list of lists) and a function as input, and returns a list. Each element of the output list is the result of applying the input function with the corresponding elements of the input vectors as arguments. Here’s an example:</p>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="maps_alg.html#cb571-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function that adds two numbers</span></span>
<span id="cb571-2"><a href="maps_alg.html#cb571-2" aria-hidden="true" tabindex="-1"></a>add <span class="ot">&lt;-</span> \(x, y) x <span class="sc">+</span> y</span>
<span id="cb571-3"><a href="maps_alg.html#cb571-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-4"><a href="maps_alg.html#cb571-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a list of two vectors of numbers</span></span>
<span id="cb571-5"><a href="maps_alg.html#cb571-5" aria-hidden="true" tabindex="-1"></a>numbers <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>))</span>
<span id="cb571-6"><a href="maps_alg.html#cb571-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-7"><a href="maps_alg.html#cb571-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the pmap function to apply the add function to the vectors</span></span>
<span id="cb571-8"><a href="maps_alg.html#cb571-8" aria-hidden="true" tabindex="-1"></a>sums <span class="ot">&lt;-</span> <span class="fu">pmap_dbl</span>(numbers, add)</span>
<span id="cb571-9"><a href="maps_alg.html#cb571-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-10"><a href="maps_alg.html#cb571-10" aria-hidden="true" tabindex="-1"></a>sums</span></code></pre></div>
<pre><code>## [1] 11 13 15</code></pre>
<p>It’s important to note that all vectors in the list passed to <code>pmap</code> should be the same length, as <code>pmap</code> will recycle shorter vectors to match the length of the longest vector, which can lead to unexpected results. If the vectors are not the same length, you should adjust them to be the same length before using <code>pmap</code>.</p>
</div>
</div>
<div id="reduce-operation" class="section level3 hasAnchor" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Reduce Operation<a href="maps_alg.html#reduce-operation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>reduce</code> operation is a function that takes a binary function (a function that takes two arguments) and a list or vector as input, and returns a single value. It works by applying the function to the first two elements of the list, then applying the function to the result and the next element, and so on, until it has processed all the elements of the list.</p>
<p>This operation is called <code>reduce</code> because it reduces a list of values down to a single value. It’s also known as <code>fold</code>, <code>accumulate</code>, <code>compress</code>, or <code>inject</code> in other programming languages.</p>
<p><a href="reduce_scheme"><img src="images/chapter4/reduce.png" width="265" /></a></p>
<p>To give an example, let’s use the <code>reduce</code> operation to compute the dot product of two vectors. We have seen this already in Chapter <a href="log_vec.html#vectors">2.4</a>, however, this time, we will implement the function ourselves! We can compute this using the <code>map2</code> operation to multiply the components and the <code>reduce</code> operation to sum the results:</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 10px;">
<div>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="maps_alg.html#cb573-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define two vectors</span></span>
<span id="cb573-2"><a href="maps_alg.html#cb573-2" aria-hidden="true" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb573-3"><a href="maps_alg.html#cb573-3" aria-hidden="true" tabindex="-1"></a>v2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>)</span>
<span id="cb573-4"><a href="maps_alg.html#cb573-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb573-5"><a href="maps_alg.html#cb573-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the map2 function to multiply the components of the vectors</span></span>
<span id="cb573-6"><a href="maps_alg.html#cb573-6" aria-hidden="true" tabindex="-1"></a>products <span class="ot">&lt;-</span> <span class="fu">map2_dbl</span>(v1, v2, <span class="st">`</span><span class="at">*</span><span class="st">`</span>)</span>
<span id="cb573-7"><a href="maps_alg.html#cb573-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb573-8"><a href="maps_alg.html#cb573-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the reduce function to sum the products</span></span>
<span id="cb573-9"><a href="maps_alg.html#cb573-9" aria-hidden="true" tabindex="-1"></a>dot_product <span class="ot">&lt;-</span> <span class="fu">reduce</span>(products, <span class="st">`</span><span class="at">+</span><span class="st">`</span>)</span>
<span id="cb573-10"><a href="maps_alg.html#cb573-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb573-11"><a href="maps_alg.html#cb573-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dot_product)</span></code></pre></div>
<pre><code>## [1] 68</code></pre>
</div>
<div>
<p><strong>Python</strong></p>
<div class="sourceCode" id="cb575"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb575-1"><a href="maps_alg.html#cb575-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> <span class="bu">reduce</span></span>
<span id="cb575-2"><a href="maps_alg.html#cb575-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb575-3"><a href="maps_alg.html#cb575-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define two lists</span></span>
<span id="cb575-4"><a href="maps_alg.html#cb575-4" aria-hidden="true" tabindex="-1"></a>v1 <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb575-5"><a href="maps_alg.html#cb575-5" aria-hidden="true" tabindex="-1"></a>v2 <span class="op">=</span> [<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>]</span>
<span id="cb575-6"><a href="maps_alg.html#cb575-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb575-7"><a href="maps_alg.html#cb575-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the map function to multiply the components of the lists</span></span>
<span id="cb575-8"><a href="maps_alg.html#cb575-8" aria-hidden="true" tabindex="-1"></a>products <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x, y: x <span class="op">*</span> y, v1, v2))</span>
<span id="cb575-9"><a href="maps_alg.html#cb575-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb575-10"><a href="maps_alg.html#cb575-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the reduce function to sum the products</span></span>
<span id="cb575-11"><a href="maps_alg.html#cb575-11" aria-hidden="true" tabindex="-1"></a>dot_product <span class="op">=</span> <span class="bu">reduce</span>(<span class="kw">lambda</span> x, y: x <span class="op">+</span> y, products)</span>
<span id="cb575-12"><a href="maps_alg.html#cb575-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb575-13"><a href="maps_alg.html#cb575-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dot_product)</span></code></pre></div>
<pre><code>## 68</code></pre>
</div>
</div>
<p>In the above examples, we’ve used the <code>map2</code>/<code>map</code> operation to multiply the components of two vectors, and the <code>reduce</code> operation to sum the results, computing the dot product of the vectors.</p>
<p><strong>Note for Python Users</strong>: The <code>reduce</code> operation in Python is part of the <code>functools</code> module, so you need to import it with <code>from functools import reduce</code>.</p>
</div>
<div id="gen-fizzbuzz" class="section level3 hasAnchor" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> Exercise: Implement a Generic FizzBuzz Function<a href="maps_alg.html#gen-fizzbuzz" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Ok, this is going to be great. The ultimate FizzBuzz. The final boss. You are a mathematician, and mathematicians generalize things. In this exercise, you are asked to generalize FizzBuzz. Solve it all. You should write a function that takes three arguments: a vector of numbers, and a vector of primes, and a vector of phrases. The vectors of primes and phrases should be of the same length, not necessarily the same length of the vector of numbers. The function should return a vector of the same length as the input vector of numbers. Each element of the output vector should be obtained by replacing each number in the input vector with the corresponding phrase if the number is divisible by the corresponding prime. If a number is divisible by more than one prime, the complete phrase should be formed by concatenating the phrases. If a number is not divisible by any of the primes, the number itself should be returned as a string.</p>
<p>For example, the simple FizzBuzz, should be, then, obtained via:</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 10px;">
<div>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="maps_alg.html#cb577-1" aria-hidden="true" tabindex="-1"></a><span class="fu">generic_fizzbuzz</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>),  <span class="fu">c</span>(<span class="st">&quot;Fizz&quot;</span>, <span class="st">&quot;Buzz&quot;</span>))</span></code></pre></div>
</div>
<div>
<p><strong>python</strong></p>
<div class="sourceCode" id="cb578"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb578-1"><a href="maps_alg.html#cb578-1" aria-hidden="true" tabindex="-1"></a>generic_fizzbuzz(<span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">16</span>), [<span class="dv">3</span>, <span class="dv">5</span>], [<span class="st">&quot;Fizz&quot;</span>, <span class="st">&quot;Buzz&quot;</span>])</span></code></pre></div>
</div>
</div>
<p>Here’s the function signature in R to get you started:</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 10px;">
<div>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="maps_alg.html#cb579-1" aria-hidden="true" tabindex="-1"></a>generic_fizzbuzz <span class="ot">&lt;-</span> <span class="cf">function</span>(x, primes, phrases) {</span>
<span id="cb579-2"><a href="maps_alg.html#cb579-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Your code here</span></span>
<span id="cb579-3"><a href="maps_alg.html#cb579-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div>
<p><strong>python</strong></p>
<div class="sourceCode" id="cb580"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb580-1"><a href="maps_alg.html#cb580-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generic_fizzbuzz(x, primes, phrases):</span>
<span id="cb580-2"><a href="maps_alg.html#cb580-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Your code here</span></span></code></pre></div>
</div>
</div>
<p>As a test case, consider the following call to your function:</p>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="maps_alg.html#cb581-1" aria-hidden="true" tabindex="-1"></a><span class="fu">generic_fizzbuzz</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>),  <span class="fu">c</span>(<span class="st">&quot;Skibbidi&quot;</span>, <span class="st">&quot;Fizz&quot;</span>, <span class="st">&quot;Buzz&quot;</span>, <span class="st">&quot;Yo&quot;</span>))</span></code></pre></div>
<p>or in Python:</p>
<div class="sourceCode" id="cb582"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb582-1"><a href="maps_alg.html#cb582-1" aria-hidden="true" tabindex="-1"></a>generic_fizzbuzz(<span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">16</span>), [<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>], [<span class="st">&quot;Skibbidi&quot;</span>, <span class="st">&quot;Fizz&quot;</span>, <span class="st">&quot;Buzz&quot;</span>, <span class="st">&quot;Yo&quot;</span>])</span></code></pre></div>
<p><strong>NOTE for R users</strong> Please check the Challenges chapter, for a last fizzbuzz challenge in Section @{gen_fizzbuzz_short}!</p>
</div>
<div id="state-in-functional-programming" class="section level3 hasAnchor" number="4.1.5">
<h3><span class="header-section-number">4.1.5</span> State in Functional Programming<a href="maps_alg.html#state-in-functional-programming" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>reduce</code> operation is a way of performing a <em>recursion</em> operation in functional programming. It applies a binary function to the first two elements of a list, then applies the function to the result and the next element, and so on, until it has processed all the elements of the list. This is essentially a function concatenation on the result of a previous iteration. Go and have a better look at Figure <a href="#fig:reduce-scheme"><strong>??</strong></a>!</p>
<p>This brings us to the concept of recursion, which is a method where the solution to a problem depends on solutions to smaller instances of the same problem. In functional programming, recursion is often used as a way to deal with <strong>state</strong>.</p>
<p>Let’s illustrate how the recursion works with the same Fibonacci series example recursion. We can define a function called <span class="math inline">\(f\)</span> that:</p>
<p><span class="math display">\[
    f(n)=
\begin{cases}
    n,&amp; \text{if } n \leq 1\\
    f(n-1) + f(n-2),              &amp; \text{otherwise}
\end{cases}
\]</span> This function, for a given <span class="math inline">\(n\)</span>, will return the corresponding <span class="math inline">\(r_n\)</span> value of the Fibonacci sequence (see past week).</p>
<p>Now, the cool thing is: it is possible to write this exact statement as a program too! Have a look at the code below:</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 10px;">
<div>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="maps_alg.html#cb583-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a recursive function to compute the Fibonacci series</span></span>
<span id="cb583-2"><a href="maps_alg.html#cb583-2" aria-hidden="true" tabindex="-1"></a>fibonacci <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb583-3"><a href="maps_alg.html#cb583-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (n <span class="sc">&lt;=</span> <span class="dv">1</span>) </span>
<span id="cb583-4"><a href="maps_alg.html#cb583-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(n)</span>
<span id="cb583-5"><a href="maps_alg.html#cb583-5" aria-hidden="true" tabindex="-1"></a>   <span class="cf">else</span> </span>
<span id="cb583-6"><a href="maps_alg.html#cb583-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">fibonacci</span>(n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">fibonacci</span>(n <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb583-7"><a href="maps_alg.html#cb583-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb583-8"><a href="maps_alg.html#cb583-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb583-9"><a href="maps_alg.html#cb583-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the first 10 numbers of the Fibonacci series</span></span>
<span id="cb583-10"><a href="maps_alg.html#cb583-10" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dbl</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>, fibonacci)</span></code></pre></div>
<pre><code>##  [1]  0  1  1  2  3  5  8 13 21 34</code></pre>
</div>
<div>
<p><strong>Python</strong></p>
<div class="sourceCode" id="cb585"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb585-1"><a href="maps_alg.html#cb585-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a recursive function to compute the Fibonacci series</span></span>
<span id="cb585-2"><a href="maps_alg.html#cb585-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fibonacci(n):</span>
<span id="cb585-3"><a href="maps_alg.html#cb585-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">&lt;=</span> <span class="dv">1</span>:</span>
<span id="cb585-4"><a href="maps_alg.html#cb585-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> n</span>
<span id="cb585-5"><a href="maps_alg.html#cb585-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb585-6"><a href="maps_alg.html#cb585-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span>(fibonacci(n <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> fibonacci(n <span class="op">-</span> <span class="dv">2</span>))</span>
<span id="cb585-7"><a href="maps_alg.html#cb585-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb585-8"><a href="maps_alg.html#cb585-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the first 10 numbers of the Fibonacci series</span></span>
<span id="cb585-9"><a href="maps_alg.html#cb585-9" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(<span class="bu">map</span>(fibonacci, <span class="bu">range</span>(<span class="dv">10</span>)))</span></code></pre></div>
<pre><code>## [0, 1, 1, 2, 3, 5, 8, 13, 21, 34]</code></pre>
</div>
</div>
<p>In the above examples, we’ve defined a recursive function <code>fibonacci</code> that computes the Fibonacci series. We then used this function compute Fibonacci series: recall that the <code>fibonacci</code> function only returns the <span class="math inline">\(n^{th}\)</span> element of the series, so to get the first 10 numbers we need a map statement.</p>
<p>However, it’s important to note that while recursion is a powerful concept, it can be impractical in practice due to its high computational complexity and the risk of running out of memory for large inputs. Most of the tasks in functional programming are either solved via <code>map</code> and <code>reduce</code> operations or, eventually, through for loops.</p>
<p><code>map</code> and <code>reduce</code> are generally more efficient, safer, and can handle larger inputs. <strong>For this reason, my friends, this is the last time we will be seeing recursions in this module</strong>. Brief but intense.</p>
<div id="exercise-fixing-gpt-shenanigans" class="section level4 hasAnchor" number="4.1.5.1">
<h4><span class="header-section-number">4.1.5.1</span> Exercise: Fixing GPT Shenanigans<a href="maps_alg.html#exercise-fixing-gpt-shenanigans" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Welcome to the future! As of January 2023, the most advanced Generative Pre-trained Transformer (like GPT-4) is about as skilled as a newbie coder.</p>
<p>In your journey, you’ll definitely cross paths with these models if you haven’t already. They’re cool, they’re trendy, everyone is talking about them, and they’re putting at risk half of the desk-job market. <strong>But remember, they’re not flawless.</strong></p>
<p>To show you what I mean, I challenged GPT-4 to code the Fibonacci sequence using a reduce statement. Check out the R and Python solution it came up with below. I copied the scripts without modifications:</p>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="maps_alg.html#cb587-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb587-2"><a href="maps_alg.html#cb587-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb587-3"><a href="maps_alg.html#cb587-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function to compute the next number in the Fibonacci series</span></span>
<span id="cb587-4"><a href="maps_alg.html#cb587-4" aria-hidden="true" tabindex="-1"></a>next_number <span class="ot">&lt;-</span> <span class="cf">function</span>(prev_numbers) {</span>
<span id="cb587-5"><a href="maps_alg.html#cb587-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">tail</span>(prev_numbers, <span class="dv">2</span>))</span>
<span id="cb587-6"><a href="maps_alg.html#cb587-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb587-7"><a href="maps_alg.html#cb587-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb587-8"><a href="maps_alg.html#cb587-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Fibonacci series up to a given length</span></span>
<span id="cb587-9"><a href="maps_alg.html#cb587-9" aria-hidden="true" tabindex="-1"></a>fibonacci_series <span class="ot">&lt;-</span> <span class="cf">function</span>(length) {</span>
<span id="cb587-10"><a href="maps_alg.html#cb587-10" aria-hidden="true" tabindex="-1"></a>  initial <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb587-11"><a href="maps_alg.html#cb587-11" aria-hidden="true" tabindex="-1"></a>  fib_sequence <span class="ot">&lt;-</span> <span class="fu">reduce</span>(<span class="fu">rep</span>(<span class="dv">0</span>, length <span class="sc">-</span> <span class="dv">2</span>), <span class="at">.init =</span> initial, <span class="at">.f =</span> next_number)</span>
<span id="cb587-12"><a href="maps_alg.html#cb587-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fib_sequence)</span>
<span id="cb587-13"><a href="maps_alg.html#cb587-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb587-14"><a href="maps_alg.html#cb587-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb587-15"><a href="maps_alg.html#cb587-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the first 10 numbers of the Fibonacci series</span></span>
<span id="cb587-16"><a href="maps_alg.html#cb587-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">fibonacci_series</span>(<span class="dv">10</span>))</span></code></pre></div>
<p><strong>Python</strong></p>
<div class="sourceCode" id="cb588"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb588-1"><a href="maps_alg.html#cb588-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> <span class="bu">reduce</span></span>
<span id="cb588-2"><a href="maps_alg.html#cb588-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb588-3"><a href="maps_alg.html#cb588-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fibonacci_series(length):</span>
<span id="cb588-4"><a href="maps_alg.html#cb588-4" aria-hidden="true" tabindex="-1"></a>    initial <span class="op">=</span> ([<span class="dv">0</span>, <span class="dv">1</span>] <span class="op">+</span> [<span class="dv">0</span>] <span class="op">*</span> (length <span class="op">-</span> <span class="dv">2</span>))</span>
<span id="cb588-5"><a href="maps_alg.html#cb588-5" aria-hidden="true" tabindex="-1"></a>    fib_sequence <span class="op">=</span> <span class="bu">reduce</span>(<span class="kw">lambda</span> prev, _: prev <span class="op">+</span> [prev[<span class="op">-</span><span class="dv">2</span>] <span class="op">+</span> prev[<span class="op">-</span><span class="dv">1</span>]], <span class="bu">range</span>(length <span class="op">-</span> <span class="dv">2</span>), initial)</span>
<span id="cb588-6"><a href="maps_alg.html#cb588-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fib_sequence</span>
<span id="cb588-7"><a href="maps_alg.html#cb588-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb588-8"><a href="maps_alg.html#cb588-8" aria-hidden="true" tabindex="-1"></a>length <span class="op">=</span> <span class="dv">10</span>  <span class="co"># Change this to the length you want</span></span>
<span id="cb588-9"><a href="maps_alg.html#cb588-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(fibonacci_series(length))</span></code></pre></div>
<p><strong>You can see it is clearly broken</strong>. Imagine you’re now in the hot seat, interviewing for a top-tier IT company. They slide this code across the table and ask you to either debug the AI’s solution or come up with a better one. Could you rise to the challenge and secure the job?</p>
</div>
</div>
</div>
<div id="doing-linear-algebra" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Doing Linear Algebra<a href="maps_alg.html#doing-linear-algebra" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="building-matrices" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Building Matrices<a href="maps_alg.html#building-matrices" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the previous chapters, we have covered some basics on how to perform operations on one-dimensional vectors, and the dot product. Now, we are going to extend our understanding to two dimensions with <strong>matrices</strong>.</p>
<p>A <strong>matrix</strong> is a mathematical term for a two-dimensional array of numbers, while a vector is a one-dimensional array. In other words, you can think of a matrix as a homogeneous vector of vectors of doubles, both in R and Python.</p>
<p>Let’s see how to create a 4x4 matrix in R and Python:</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 10px;">
<div>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="maps_alg.html#cb589-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a 4x4 matrix in R</span></span>
<span id="cb589-2"><a href="maps_alg.html#cb589-2" aria-hidden="true" tabindex="-1"></a>matrix_by_row <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>, <span class="at">nrow=</span><span class="dv">4</span>, <span class="at">ncol=</span><span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb589-3"><a href="maps_alg.html#cb589-3" aria-hidden="true" tabindex="-1"></a>matrix_by_row</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    2    3    4
## [2,]    5    6    7    8
## [3,]    9   10   11   12
## [4,]   13   14   15   16</code></pre>
</div>
<div>
<p><strong>Python</strong></p>
<div class="sourceCode" id="cb591"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb591-1"><a href="maps_alg.html#cb591-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a 4x4 matrix in Python</span></span>
<span id="cb591-2"><a href="maps_alg.html#cb591-2" aria-hidden="true" tabindex="-1"></a>matrix_by_row <span class="op">=</span> np.arange(<span class="dv">1</span>, <span class="dv">17</span>).reshape(<span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb591-3"><a href="maps_alg.html#cb591-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb591-4"><a href="maps_alg.html#cb591-4" aria-hidden="true" tabindex="-1"></a><span class="co"># alternatively, you can write it by hand as a list of lists</span></span>
<span id="cb591-5"><a href="maps_alg.html#cb591-5" aria-hidden="true" tabindex="-1"></a>matrix_by_row <span class="op">=</span> np.array([</span>
<span id="cb591-6"><a href="maps_alg.html#cb591-6" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>],</span>
<span id="cb591-7"><a href="maps_alg.html#cb591-7" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>],</span>
<span id="cb591-8"><a href="maps_alg.html#cb591-8" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>],</span>
<span id="cb591-9"><a href="maps_alg.html#cb591-9" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">15</span>, <span class="dv">16</span>]</span>
<span id="cb591-10"><a href="maps_alg.html#cb591-10" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb591-11"><a href="maps_alg.html#cb591-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb591-12"><a href="maps_alg.html#cb591-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb591-13"><a href="maps_alg.html#cb591-13" aria-hidden="true" tabindex="-1"></a>matrix_by_row</span></code></pre></div>
<pre><code>## array([[ 1,  2,  3,  4],
##        [ 5,  6,  7,  8],
##        [ 9, 10, 11, 12],
##        [13, 14, 15, 16]])</code></pre>
</div>
</div>
<p>In the above examples, we’ve created a 4x4 matrix filled by rows. You can also fill the matrix by columns by setting <code>byrow = FALSE</code> in R, or by reshaping a range in Python (<code>reshape</code> will fill automatically by row).</p>
<p>Additionally, you can create a matrix by binding vectors together. In R, you can use <code>cbind()</code> to bind vectors as columns or <code>rbind()</code> to bind vectors as rows, whilist in python you can use <code>np.column_stack()</code> as columns and <code>np.row_stack()</code> as rows:</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 10px;">
<div>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb593-1"><a href="maps_alg.html#cb593-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a matrix by binding vectors in R</span></span>
<span id="cb593-2"><a href="maps_alg.html#cb593-2" aria-hidden="true" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb593-3"><a href="maps_alg.html#cb593-3" aria-hidden="true" tabindex="-1"></a>v2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>)</span>
<span id="cb593-4"><a href="maps_alg.html#cb593-4" aria-hidden="true" tabindex="-1"></a>v3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>)</span>
<span id="cb593-5"><a href="maps_alg.html#cb593-5" aria-hidden="true" tabindex="-1"></a>v4 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">15</span>, <span class="dv">16</span>)</span>
<span id="cb593-6"><a href="maps_alg.html#cb593-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb593-7"><a href="maps_alg.html#cb593-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Bind vectors as columns</span></span>
<span id="cb593-8"><a href="maps_alg.html#cb593-8" aria-hidden="true" tabindex="-1"></a>matrix_by_col <span class="ot">&lt;-</span> <span class="fu">cbind</span>(v1, v2, v3, v4)</span>
<span id="cb593-9"><a href="maps_alg.html#cb593-9" aria-hidden="true" tabindex="-1"></a>matrix_by_col</span></code></pre></div>
<pre><code>##      v1 v2 v3 v4
## [1,]  1  5  9 13
## [2,]  2  6 10 14
## [3,]  3  7 11 15
## [4,]  4  8 12 16</code></pre>
</div>
<div>
<p><strong>Python</strong></p>
<div class="sourceCode" id="cb595"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb595-1"><a href="maps_alg.html#cb595-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a matrix by binding vectors in Python</span></span>
<span id="cb595-2"><a href="maps_alg.html#cb595-2" aria-hidden="true" tabindex="-1"></a>v1 <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])</span>
<span id="cb595-3"><a href="maps_alg.html#cb595-3" aria-hidden="true" tabindex="-1"></a>v2 <span class="op">=</span> np.array([<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>])</span>
<span id="cb595-4"><a href="maps_alg.html#cb595-4" aria-hidden="true" tabindex="-1"></a>v3 <span class="op">=</span> np.array([<span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>])</span>
<span id="cb595-5"><a href="maps_alg.html#cb595-5" aria-hidden="true" tabindex="-1"></a>v4 <span class="op">=</span> np.array([<span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">15</span>, <span class="dv">16</span>])</span>
<span id="cb595-6"><a href="maps_alg.html#cb595-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb595-7"><a href="maps_alg.html#cb595-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Bind vectors as columns</span></span>
<span id="cb595-8"><a href="maps_alg.html#cb595-8" aria-hidden="true" tabindex="-1"></a>matrix_by_col <span class="op">=</span> np.column_stack((v1, v2, v3, v4))</span>
<span id="cb595-9"><a href="maps_alg.html#cb595-9" aria-hidden="true" tabindex="-1"></a>matrix_by_col</span></code></pre></div>
<pre><code>## array([[ 1,  5,  9, 13],
##        [ 2,  6, 10, 14],
##        [ 3,  7, 11, 15],
##        [ 4,  8, 12, 16]])</code></pre>
</div>
</div>
<p>In the above examples, we’ve created a 4x4 matrix by binding four vectors as columns. You can also bind vectors as rows by using <code>rbind()</code> in R, or <code>np.vstack()</code> in Python.</p>
<p>Now, let’s illustrate the transpose operation. Recall that the transpose of a matrix is obtained by flipping it over its diagonal. This switches the row and column indices of each element. In R, you can use the <code>t()</code> function to transpose a matrix, while in Python, you can use the <code>T</code> attribute or the <code>transpose()</code> function.</p>
<p>Let’s compare the matrices created above with their transposes:</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 10px;">
<div>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb597-1"><a href="maps_alg.html#cb597-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transpose the matrix in R</span></span>
<span id="cb597-2"><a href="maps_alg.html#cb597-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(matrix_by_row)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    5    9   13
## [2,]    2    6   10   14
## [3,]    3    7   11   15
## [4,]    4    8   12   16</code></pre>
<div class="sourceCode" id="cb599"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb599-1"><a href="maps_alg.html#cb599-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing the elements of the transposed</span></span>
<span id="cb599-2"><a href="maps_alg.html#cb599-2" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix by row with that filled by columns</span></span>
<span id="cb599-3"><a href="maps_alg.html#cb599-3" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(matrix_by_row) <span class="sc">==</span> matrix_by_col</span></code></pre></div>
<pre><code>##        v1   v2   v3   v4
## [1,] TRUE TRUE TRUE TRUE
## [2,] TRUE TRUE TRUE TRUE
## [3,] TRUE TRUE TRUE TRUE
## [4,] TRUE TRUE TRUE TRUE</code></pre>
</div>
<div>
<p><strong>Python</strong></p>
<div class="sourceCode" id="cb601"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb601-1"><a href="maps_alg.html#cb601-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transpose the matrix in Python</span></span>
<span id="cb601-2"><a href="maps_alg.html#cb601-2" aria-hidden="true" tabindex="-1"></a>matrix_by_row.T</span></code></pre></div>
<pre><code>## array([[ 1,  5,  9, 13],
##        [ 2,  6, 10, 14],
##        [ 3,  7, 11, 15],
##        [ 4,  8, 12, 16]])</code></pre>
<div class="sourceCode" id="cb603"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb603-1"><a href="maps_alg.html#cb603-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing the elements of the transposed</span></span>
<span id="cb603-2"><a href="maps_alg.html#cb603-2" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix by row with that filled by columns</span></span>
<span id="cb603-3"><a href="maps_alg.html#cb603-3" aria-hidden="true" tabindex="-1"></a>matrix_by_row.T <span class="op">==</span> matrix_by_col</span></code></pre></div>
<pre><code>## array([[ True,  True,  True,  True],
##        [ True,  True,  True,  True],
##        [ True,  True,  True,  True],
##        [ True,  True,  True,  True]])</code></pre>
</div>
</div>
<p>As you can see, unsurprisingly, the transpose of the filled by row has all elements equals to the one filled by column.</p>
</div>
<div id="matrix-operations" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Matrix Operations<a href="maps_alg.html#matrix-operations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As with vectors, we can do operations with matrices. We’ll start by creating a simple 3x3 matrix, and a 3x1 vector.</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 10px;">
<div>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="maps_alg.html#cb605-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a 3x3 matrix in R</span></span>
<span id="cb605-2"><a href="maps_alg.html#cb605-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>), <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb605-3"><a href="maps_alg.html#cb605-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb605-4"><a href="maps_alg.html#cb605-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a 3x1 vector in R</span></span>
<span id="cb605-5"><a href="maps_alg.html#cb605-5" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span></code></pre></div>
</div>
<div>
<p><strong>Python</strong></p>
<div class="sourceCode" id="cb606"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb606-1"><a href="maps_alg.html#cb606-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a 3x3 matrix in Python</span></span>
<span id="cb606-2"><a href="maps_alg.html#cb606-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.arange(<span class="dv">1</span>,<span class="dv">10</span>).reshape(<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb606-3"><a href="maps_alg.html#cb606-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb606-4"><a href="maps_alg.html#cb606-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a 3x1 vector in Python</span></span>
<span id="cb606-5"><a href="maps_alg.html#cb606-5" aria-hidden="true" tabindex="-1"></a>v <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span></code></pre></div>
</div>
</div>
<p>Now, as in chapter two, R and Python (assuming you’re using numpy) will be able to handle both:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Element-wise Operations</strong>: These operations are performed on corresponding elements of matrices. This is simply done by calling a given function on a matrix. There’s few examples below, including element-wise multiplication, also known as the Hadamard product.</p></li>
<li><p><strong>Matrix Multiplication</strong>: Remember, the dimensions of the matrices must be compatible for these operations to be valid: when we multiply two matrices, the number of columns in the first matrix should be equal to the number of rows in the second matrix. If they’re not, you’ll get an error. The resulting matrix has each element as the dot product of the corresponding row and column from the input matrices.</p></li>
</ol>
<p>Let’s see these operations in action:</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 10px;">
<div>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="maps_alg.html#cb607-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix addition</span></span>
<span id="cb607-2"><a href="maps_alg.html#cb607-2" aria-hidden="true" tabindex="-1"></a>A <span class="sc">+</span> A</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    2    8   14
## [2,]    4   10   16
## [3,]    6   12   18</code></pre>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="maps_alg.html#cb609-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Element-wise multiplication</span></span>
<span id="cb609-2"><a href="maps_alg.html#cb609-2" aria-hidden="true" tabindex="-1"></a>A <span class="sc">*</span> A</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1   16   49
## [2,]    4   25   64
## [3,]    9   36   81</code></pre>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="maps_alg.html#cb611-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Squaring all elements (equivalent to above)</span></span>
<span id="cb611-2"><a href="maps_alg.html#cb611-2" aria-hidden="true" tabindex="-1"></a>A<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1   16   49
## [2,]    4   25   64
## [3,]    9   36   81</code></pre>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="maps_alg.html#cb613-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix multiplication</span></span>
<span id="cb613-2"><a href="maps_alg.html#cb613-2" aria-hidden="true" tabindex="-1"></a>A <span class="sc">%*%</span> A</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]   30   66  102
## [2,]   36   81  126
## [3,]   42   96  150</code></pre>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="maps_alg.html#cb615-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix-vector multiplication</span></span>
<span id="cb615-2"><a href="maps_alg.html#cb615-2" aria-hidden="true" tabindex="-1"></a>A <span class="sc">%*%</span> v</span></code></pre></div>
<pre><code>##      [,1]
## [1,]   30
## [2,]   36
## [3,]   42</code></pre>
</div>
<div>
<p><strong>Python</strong></p>
<div class="sourceCode" id="cb617"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb617-1"><a href="maps_alg.html#cb617-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix addition</span></span>
<span id="cb617-2"><a href="maps_alg.html#cb617-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">+</span> A</span></code></pre></div>
<pre><code>## array([[ 2,  4,  6],
##        [ 8, 10, 12],
##        [14, 16, 18]])</code></pre>
<div class="sourceCode" id="cb619"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb619-1"><a href="maps_alg.html#cb619-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Element-wise multiplication</span></span>
<span id="cb619-2"><a href="maps_alg.html#cb619-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">*</span> A</span></code></pre></div>
<pre><code>## array([[ 1,  4,  9],
##        [16, 25, 36],
##        [49, 64, 81]])</code></pre>
<div class="sourceCode" id="cb621"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb621-1"><a href="maps_alg.html#cb621-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Squaring all elements (equivalent to above)</span></span>
<span id="cb621-2"><a href="maps_alg.html#cb621-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">**</span> <span class="dv">2</span></span></code></pre></div>
<pre><code>## array([[ 1,  4,  9],
##        [16, 25, 36],
##        [49, 64, 81]])</code></pre>
<div class="sourceCode" id="cb623"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb623-1"><a href="maps_alg.html#cb623-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix multiplication</span></span>
<span id="cb623-2"><a href="maps_alg.html#cb623-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">@</span> A</span></code></pre></div>
<pre><code>## array([[ 30,  36,  42],
##        [ 66,  81,  96],
##        [102, 126, 150]])</code></pre>
<div class="sourceCode" id="cb625"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb625-1"><a href="maps_alg.html#cb625-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix-vector multiplication</span></span>
<span id="cb625-2"><a href="maps_alg.html#cb625-2" aria-hidden="true" tabindex="-1"></a>np.dot(A, v) <span class="co"># as we saw in week 2</span></span></code></pre></div>
<pre><code>## array([14, 32, 50])</code></pre>
<div class="sourceCode" id="cb627"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb627-1"><a href="maps_alg.html#cb627-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">@</span> v</span></code></pre></div>
<pre><code>## array([14, 32, 50])</code></pre>
</div>
</div>
<div id="inversion-eigenvalues-and-eigenvectors" class="section level4 hasAnchor" number="4.2.2.1">
<h4><span class="header-section-number">4.2.2.1</span> Inversion, Eigenvalues and Eigenvectors<a href="maps_alg.html#inversion-eigenvalues-and-eigenvectors" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For this section, we’ll reuse the matrix <code>A</code> from the previous examples. The rank of A, is, however, 2, as the third column is the sum of the first and second columns. This is going to be cool as it’s going to show us what happens on a computer when a matrix that does not have a unique inverse. Of course, as a counter example, we need to introduce a new full rank matrix <code>B</code> which will have a unique inverse:</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 10px;">
<div>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="maps_alg.html#cb629-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a full rank matrix</span></span>
<span id="cb629-2"><a href="maps_alg.html#cb629-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">3</span>), <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">byrow=</span>T)</span>
<span id="cb629-3"><a href="maps_alg.html#cb629-3" aria-hidden="true" tabindex="-1"></a>B</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]    4    5    6
## [3,]    1    4    3</code></pre>
</div>
<div>
<p><strong>Python</strong></p>
<div class="sourceCode" id="cb631"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb631-1"><a href="maps_alg.html#cb631-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a full rank matrix</span></span>
<span id="cb631-2"><a href="maps_alg.html#cb631-2" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">3</span>]])</span>
<span id="cb631-3"><a href="maps_alg.html#cb631-3" aria-hidden="true" tabindex="-1"></a>B</span></code></pre></div>
<pre><code>## array([[1, 2, 3],
##        [4, 5, 6],
##        [1, 4, 3]])</code></pre>
</div>
</div>
<p>Now, let’s compute the determinant of our matrices <code>A</code> and <code>B</code>:</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 10px;">
<div>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="maps_alg.html#cb633-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the determinant of A and B</span></span>
<span id="cb633-2"><a href="maps_alg.html#cb633-2" aria-hidden="true" tabindex="-1"></a><span class="fu">det</span>(A)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb635-1"><a href="maps_alg.html#cb635-1" aria-hidden="true" tabindex="-1"></a><span class="fu">det</span>(B)</span></code></pre></div>
<pre><code>## [1] 12</code></pre>
</div>
<div>
<p><strong>Python</strong></p>
<div class="sourceCode" id="cb637"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb637-1"><a href="maps_alg.html#cb637-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the determinant of A and B</span></span>
<span id="cb637-2"><a href="maps_alg.html#cb637-2" aria-hidden="true" tabindex="-1"></a>np.linalg.det(A)</span></code></pre></div>
<pre><code>## 0.0</code></pre>
<div class="sourceCode" id="cb639"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb639-1"><a href="maps_alg.html#cb639-1" aria-hidden="true" tabindex="-1"></a>np.linalg.det(B)</span></code></pre></div>
<pre><code>## 12.0</code></pre>
</div>
</div>
<p>As you can see, the determinant of a full-rank matrix is non-zero, while the determinant of a non-full rank matrix is zero.</p>
<p>Next, let’s compute the inverse of our matrices. Remember, only full-rank matrices have an inverse:</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 10px;">
<div>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb641-1"><a href="maps_alg.html#cb641-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the inverse of A</span></span>
<span id="cb641-2"><a href="maps_alg.html#cb641-2" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(A)</span></code></pre></div>
<pre><code>## Error in solve.default(A): Lapack routine dgesv: system is exactly singular: U[3,3] = 0</code></pre>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb643-1"><a href="maps_alg.html#cb643-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the inverse of B</span></span>
<span id="cb643-2"><a href="maps_alg.html#cb643-2" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(B)</span></code></pre></div>
<pre><code>##            [,1]       [,2]  [,3]
## [1,] -0.7500000  0.5000000 -0.25
## [2,] -0.5000000  0.0000000  0.50
## [3,]  0.9166667 -0.1666667 -0.25</code></pre>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb645-1"><a href="maps_alg.html#cb645-1" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(B) <span class="sc">%*%</span> B</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    0    0
## [2,]    0    1    0
## [3,]    0    0    1</code></pre>
</div>
<div>
<p><strong>Python</strong></p>
<div class="sourceCode" id="cb647"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb647-1"><a href="maps_alg.html#cb647-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the inverse of A in Python</span></span>
<span id="cb647-2"><a href="maps_alg.html#cb647-2" aria-hidden="true" tabindex="-1"></a>np.linalg.inv(A)</span></code></pre></div>
<pre><code>## Singular matrix</code></pre>
<div class="sourceCode" id="cb649"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb649-1"><a href="maps_alg.html#cb649-1" aria-hidden="true" tabindex="-1"></a>np.linalg.inv(B)</span></code></pre></div>
<pre><code>## array([[-0.75      ,  0.5       , -0.25      ],
##        [-0.5       ,  0.        ,  0.5       ],
##        [ 0.91666667, -0.16666667, -0.25      ]])</code></pre>
<div class="sourceCode" id="cb651"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb651-1"><a href="maps_alg.html#cb651-1" aria-hidden="true" tabindex="-1"></a>np.dot(np.linalg.inv(B), B)</span></code></pre></div>
<pre><code>## array([[1., 0., 0.],
##        [0., 1., 0.],
##        [0., 0., 1.]])</code></pre>
</div>
</div>
<p>Finally, let’s compute the eigenvalues and eigenvectors of our matrices <code>A</code> and <code>B</code>. The eigenvalues and eigenvectors provide important insights into the properties of the matrix:</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 10px;">
<div>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb653"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb653-1"><a href="maps_alg.html#cb653-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the eigenvalues and eigenvectors of A and B in R</span></span>
<span id="cb653-2"><a href="maps_alg.html#cb653-2" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(A)</span></code></pre></div>
<pre><code>## eigen() decomposition
## $values
## [1]  1.611684e+01 -1.116844e+00 -5.700691e-16
## 
## $vectors
##            [,1]       [,2]       [,3]
## [1,] -0.4645473 -0.8829060  0.4082483
## [2,] -0.5707955 -0.2395204 -0.8164966
## [3,] -0.6770438  0.4038651  0.4082483</code></pre>
<div class="sourceCode" id="cb655"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb655-1"><a href="maps_alg.html#cb655-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(B)</span></code></pre></div>
<pre><code>## eigen() decomposition
## $values
## [1] 10.2807637+0.0000000i -0.6403818+0.8701377i
## [3] -0.6403818-0.8701377i
## 
## $vectors
##              [,1]                  [,2]
## [1,] 0.3318753+0i -0.2937554-0.4626440i
## [2,] 0.8067885+0i -0.4955070+0.2516526i
## [3,] 0.4888263+0i  0.6251497+0.0000000i
##                       [,3]
## [1,] -0.2937554+0.4626440i
## [2,] -0.4955070-0.2516526i
## [3,]  0.6251497+0.0000000i</code></pre>
</div>
<div>
<p><strong>Python</strong></p>
<div class="sourceCode" id="cb657"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb657-1"><a href="maps_alg.html#cb657-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the eigenvalues and eigenvectors of A and B in Python</span></span>
<span id="cb657-2"><a href="maps_alg.html#cb657-2" aria-hidden="true" tabindex="-1"></a>np.linalg.eig(A)</span></code></pre></div>
<pre><code>## EigResult(eigenvalues=array([ 1.61168440e+01, -1.11684397e+00, -1.30367773e-15]), eigenvectors=array([[-0.23197069, -0.78583024,  0.40824829],
##        [-0.52532209, -0.08675134, -0.81649658],
##        [-0.8186735 ,  0.61232756,  0.40824829]]))</code></pre>
<div class="sourceCode" id="cb659"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb659-1"><a href="maps_alg.html#cb659-1" aria-hidden="true" tabindex="-1"></a>np.linalg.eig(B)</span></code></pre></div>
<pre><code>## EigResult(eigenvalues=array([10.28076366+0.j        , -0.64038183+0.87013768j,
##        -0.64038183-0.87013768j]), eigenvectors=array([[ 0.33187527+0.j        , -0.29375539-0.46264397j,
##         -0.29375539+0.46264397j],
##        [ 0.80678845+0.j        , -0.49550702+0.25165256j,
##         -0.49550702-0.25165256j],
##        [ 0.48882634+0.j        ,  0.62514967+0.j        ,
##          0.62514967-0.j        ]]))</code></pre>
</div>
</div>
<p><strong>In R</strong>, the <code>eigen()</code> function returns a list containing two components: <code>values</code> and <code>vectors</code>, which represent the eigenvalues and eigenvectors, respectively. Those are stored in a list (we have seen this earlier). You can access the elements of a list using the <code>$</code> operator. For example, if <code>result</code> is the output of <code>eigen(B)</code>, e.g. <code>result &lt;- eigen(B)</code> you can access the eigenvalues with <code>result$values</code> and the eigenvectors with <code>result$vectors</code>. Alternatively, you can access the first element of a list via <code>result[[1]]</code> and the second via <code>result[[2]]</code>.</p>
<p><strong>In Python</strong>, the <code>np.linalg.eig()</code> function returns a tuple containing the eigenvalues and eigenvectors. This result can be interpreted as an object of type <code>EigResult</code>. An object in Python is an instance of a class, which can have attributes (data associated with the object) and methods (functions associated with the object). You can access the attributes of an object using the <code>.</code> operator. For example, if <code>result</code> is the output of <code>np.linalg.eig(B)</code>, e.g. <code>result &lt;- eigen(B)</code>, you can access the eigenvalues with <code>result.eigenvalues</code> and the eigenvectors with <code>result.eigenvectors</code>. Surprisingly enough, you used methods already all this time without knowing! Think about the many occasions you used a <code>.</code>: you were accessing a method in an object.</p>
</div>
</div>
<div id="exercise-implementing-a-linear-model-solver" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Exercise: Implementing a Linear Model Solver<a href="maps_alg.html#exercise-implementing-a-linear-model-solver" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this exercise, we will implement a linear model solver from scratch. This will help you understand the underlying mathematics of linear regression and how it can be implemented in code.</p>
<p>A linear model is a mathematical model that assumes a linear relationship between the input variables (<span class="math inline">\(X\)</span>) and the single output variable (<span class="math inline">\(y\)</span>). More specifically, that y can be calculated from a linear combination of the input variables (<span class="math inline">\(X\)</span>). When there is a single input variable, the method is referred to as simple linear regression.</p>
<p>The general form of this model is:</p>
<p><span class="math display">\[y = X\beta + \epsilon\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(y\)</span> is the output variable.</p></li>
<li><p><span class="math inline">\(X\)</span> is the input variable.</p></li>
<li><p><span class="math inline">\(\beta\)</span> is the vector of coefficients.</p></li>
<li><p><span class="math inline">\(\epsilon\)</span> is the error term.</p></li>
</ul>
<p>The coefficients of the linear model can be estimated using the formula for <span class="math inline">\(\hat{\beta}\)</span>:</p>
<p><span class="math display">\[\hat{\beta} = (X^T X)^{-1} X^T y\]</span></p>
<ol style="list-style-type: decimal">
<li>Write some code to create the matrix and vector</li>
</ol>
<p><span class="math display">\[
X = \begin{bmatrix}
1 &amp; 2 \\
1 &amp; 3 \\
1 &amp; 4 \\
1 &amp; 5 \\
\end{bmatrix},\
y = \begin{bmatrix}
2 \\
3 \\
4 \\
5 \\
\end{bmatrix}.
\]</span> 2. Using the formula above, estimate the coefficients <span class="math inline">\(\hat{\beta}\)</span>.</p>
</div>
</div>
<div id="an-end-note-to-this-chapter" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> An end note to this chapter<a href="maps_alg.html#an-end-note-to-this-chapter" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Both R and Python are multi-paradigm languages. This means that they have functional programming features, such as those we saw today, as well as <strong>object oriented programming</strong> features (R, in particular, supports even <em>multiple dispatch</em>). We have covered the functional programming today as this is a scientific computing module, but we won’t cover the object oriented paradigm. I heavily encourage you to research about it in your own time, in particular if you enjoy programming. Those are all concepts that gravitate around how we define objects on a computer, and how these objects should interact with functions. It can get pretty abstract really quickly, and there’s no true solution on which one is the best paradigm – I personally like a blend of both. And to this date, I still have intense arguments with colleagues about what’s the best way of translating something into code, particularly mathematical concepts. For your learning journey, R, being a slab of several programming paradigms, it’s a great playground to test and compare these concepts in practice. Recall it was created from a 1970s programming language, and was modernized at least 3 times, to include 3 implementations of object oriented programming and several functional programming features. You could say I have a love/hate relationship with R…</p>
<p><img src="images/chapter4/Rprog.png" /></p>
<style type="text/css">
.book .book-body .page-wrapper .page-inner {
  max-width: 1200px !important;
}
</style>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="func_loop.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="df_plt.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
