<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Root finding | Lancaster University MATH245 Computational Mathematics</title>
  <meta name="description" content="7 Root finding | Lancaster University MATH245 Computational Mathematics" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Root finding | Lancaster University MATH245 Computational Mathematics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Root finding | Lancaster University MATH245 Computational Mathematics" />
  
  
  

<meta name="author" content="Lecturers: Dr Eduard Campillo-Funollet and Dr Gaetano Romano" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="fixed.html"/>
<link rel="next" href="challenge.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro_prog.html"><a href="intro_prog.html"><i class="fa fa-check"></i><b>1</b> Introduction to Computational Mathematics</a><ul>
<li class="chapter" data-level="1.1" data-path="intro_prog.html"><a href="intro_prog.html#what-is-a-computer"><i class="fa fa-check"></i><b>1.1</b> What is a Computer?</a></li>
<li class="chapter" data-level="1.2" data-path="intro_prog.html"><a href="intro_prog.html#computing-accessing-memory-and-storing"><i class="fa fa-check"></i><b>1.2</b> Computing, Accessing Memory and Storing</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="log_vec.html"><a href="log_vec.html"><i class="fa fa-check"></i><b>2</b> Logic and Vectors</a><ul>
<li class="chapter" data-level="2.1" data-path="log_vec.html"><a href="log_vec.html#comparisons"><i class="fa fa-check"></i><b>2.1</b> Comparisons</a></li>
<li class="chapter" data-level="2.2" data-path="log_vec.html"><a href="log_vec.html#logical-arithmetic"><i class="fa fa-check"></i><b>2.2</b> Logical Arithmetic</a></li>
<li class="chapter" data-level="2.3" data-path="log_vec.html"><a href="log_vec.html#flow"><i class="fa fa-check"></i><b>2.3</b> Flow</a></li>
<li class="chapter" data-level="2.4" data-path="log_vec.html"><a href="log_vec.html#vectors"><i class="fa fa-check"></i><b>2.4</b> Vectors</a></li>
<li class="chapter" data-level="2.5" data-path="log_vec.html"><a href="log_vec.html#accessing-vectors"><i class="fa fa-check"></i><b>2.5</b> Accessing vectors</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="func_loop.html"><a href="func_loop.html"><i class="fa fa-check"></i><b>3</b> Functions and Loops</a><ul>
<li class="chapter" data-level="3.1" data-path="func_loop.html"><a href="func_loop.html#functions"><i class="fa fa-check"></i><b>3.1</b> Functions</a></li>
<li class="chapter" data-level="3.2" data-path="func_loop.html"><a href="func_loop.html#looping"><i class="fa fa-check"></i><b>3.2</b> State and For Loop</a></li>
<li class="chapter" data-level="3.3" data-path="func_loop.html"><a href="func_loop.html#more-about-looping"><i class="fa fa-check"></i><b>3.3</b> More about looping</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="maps_alg.html"><a href="maps_alg.html"><i class="fa fa-check"></i><b>4</b> Functional Programming and Linear Algebra</a><ul>
<li class="chapter" data-level="4.1" data-path="maps_alg.html"><a href="maps_alg.html#Maps"><i class="fa fa-check"></i><b>4.1</b> An intro to Functional Programming</a></li>
<li class="chapter" data-level="4.2" data-path="maps_alg.html"><a href="maps_alg.html#doing-linear-algebra"><i class="fa fa-check"></i><b>4.2</b> Doing Linear Algebra</a></li>
<li class="chapter" data-level="4.3" data-path="maps_alg.html"><a href="maps_alg.html#an-end-note-to-this-chapter"><i class="fa fa-check"></i><b>4.3</b> An end note to this chapter</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="df_plt.html"><a href="df_plt.html"><i class="fa fa-check"></i><b>5</b> Data Frames and Plotting</a><ul>
<li class="chapter" data-level="5.1" data-path="df_plt.html"><a href="df_plt.html#data-frames"><i class="fa fa-check"></i><b>5.1</b> Data Frames</a></li>
<li class="chapter" data-level="5.2" data-path="df_plt.html"><a href="df_plt.html#plotting-with-ggplot-and-plotnine"><i class="fa fa-check"></i><b>5.2</b> Plotting with ggplot (and plotnine)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="fixed.html"><a href="fixed.html"><i class="fa fa-check"></i><b>6</b> Fixed point iteration</a><ul>
<li class="chapter" data-level="6.1" data-path="fixed.html"><a href="fixed.html#fixed-points"><i class="fa fa-check"></i><b>6.1</b> Fixed points</a></li>
<li class="chapter" data-level="6.2" data-path="fixed.html"><a href="fixed.html#convergence"><i class="fa fa-check"></i><b>6.2</b> Convergence</a></li>
<li class="chapter" data-level="6.3" data-path="fixed.html"><a href="fixed.html#fixed-point-theorems"><i class="fa fa-check"></i><b>6.3</b> Fixed point theorems</a></li>
<li class="chapter" data-level="6.4" data-path="fixed.html"><a href="fixed.html#exercises"><i class="fa fa-check"></i><b>6.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="roots.html"><a href="roots.html"><i class="fa fa-check"></i><b>7</b> Root finding</a><ul>
<li class="chapter" data-level="7.1" data-path="roots.html"><a href="roots.html#fixed-point-iteration-1"><i class="fa fa-check"></i><b>7.1</b> Fixed point iteration</a></li>
<li class="chapter" data-level="7.2" data-path="roots.html"><a href="roots.html#convergence-1"><i class="fa fa-check"></i><b>7.2</b> Convergence</a></li>
<li class="chapter" data-level="7.3" data-path="roots.html"><a href="roots.html#fixed-point-theorems-1"><i class="fa fa-check"></i><b>7.3</b> Fixed point theorems</a></li>
<li class="chapter" data-level="7.4" data-path="roots.html"><a href="roots.html#exercises-1"><i class="fa fa-check"></i><b>7.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="challenge.html"><a href="challenge.html"><i class="fa fa-check"></i><b>8</b> Additional Programming Challenges</a><ul>
<li class="chapter" data-level="8.1" data-path="challenge.html"><a href="challenge.html#part-1-scientific-computing"><i class="fa fa-check"></i><b>8.1</b> Part 1: Scientific Computing</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Lancaster University MATH245 Computational Mathematics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="roots" class="section level1 hasAnchor">
<h1><span class="header-section-number">7</span> Root finding<a href="roots.html#roots" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Root finding is a fancy name for a very common task in mathematics: solving an
equation. Any equation can be written in the form <span class="math inline">\(f(x) = 0\)</span>, for a suitable
function <span class="math inline">\(f\)</span>, and then solving the equation means finding a zero of <span class="math inline">\(f\)</span>. A root
is just an alternative name for the zeros of a function, that you already know
from studying the <em>roots</em> of polynomials.</p>
<p>We are going to study algorithms for root finding. From a mathematical
perspective, we would like to build a sequence that converges t to the root of
a given function <span class="math inline">\(f\)</span>.</p>
<div id="fixed-point-iteration-1" class="section level2 hasAnchor">
<h2><span class="header-section-number">7.1</span> Fixed point iteration<a href="roots.html#fixed-point-iteration-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can always rephrase a root finding problem <span class="math inline">\(f(x) = 0\)</span> to a fixed point problem! Let <span class="math inline">\(g(x) = f(x) + x\)</span>. Then
<span class="math display">\[
f(x) = 0 \Longleftrightarrow g(x) = x.
\]</span></p>
<div id="fixed-point-iteration-2" class="section level3 hasAnchor">
<h3><span class="header-section-number">7.1.1</span> Fixed point iteration<a href="roots.html#fixed-point-iteration-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We are interested in finding fixed points of a given function <span class="math inline">\(f\)</span>. To construct an algorithm to find fixed points, we exploit the definition of a fixed point: a fixed point is invariant when we apply the function <span class="math inline">\(f\)</span>. This suggests an iterative algorithm, starting from an initial point <span class="math inline">\(x_0\)</span>, and defining the sequence
<span class="math display">\[
x_{n+1} = f(x_n).
\]</span></p>
<p>If the sequence <span class="math inline">\((x_n)_n\)</span> contains a fixed point <span class="math inline">\(x^*\)</span> of <span class="math inline">\(f\)</span>, then <span class="math inline">\(x_n\)</span> converges to <span class="math inline">\(x^*\)</span>.</p>
<p><strong>Exercise:</strong> Prove the previous statement.</p>
<p>But with the right assumptions, we can actual say more. Assume the sequence
<span class="math inline">\((x_n)_n\)</span> defined above converges to a limit <span class="math inline">\(x^*\)</span>. Then, <em>under suitable assumptions on the function</em> <span class="math inline">\(f\)</span> we have
<span class="math display">\[
f(x^*) = f \left (\lim_{n \to \infty} x_n \right ) = \lim_{n \to \infty} f(x_n) = \lim_{n \to \infty} x_{n+1} = x^*.
\]</span></p>
<p>Note that the key step is the second equality. In general, that is only true if <span class="math inline">\(x\)</span> is continuous. The first and last equalities rely on the assumption that <span class="math inline">\((x_n)\)</span> converges to <span class="math inline">\(x^*\)</span>; the third equality is the definition of <span class="math inline">\(x_n\)</span>.</p>
<p>This suggests a very simple algorithm to find fixed points of a function <span class="math inline">\(f\)</span>: pick an initial point <span class="math inline">\(x_0\)</span>, and recursively compute <span class="math inline">\(x_{n+1} = f(x_n)\)</span>.</p>
</div>
<div id="examples-1" class="section level3 hasAnchor">
<h3><span class="header-section-number">7.1.2</span> Examples<a href="roots.html#examples-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s start by fixing the number of iterations. Then, a natural implementation of the fixed point algorithm is to use a <em>for</em> loop.</p>
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); grid-column-gap: 10px;">
<div>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb861"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb861-1" title="1"><span class="co"># Define our function f (cosine).</span></a>
<a class="sourceLine" id="cb861-2" title="2">f &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">cos</span>(x)</a>
<a class="sourceLine" id="cb861-3" title="3"></a>
<a class="sourceLine" id="cb861-4" title="4"><span class="co"># Define initial point x_0.</span></a>
<a class="sourceLine" id="cb861-5" title="5">x &lt;-<span class="st"> </span><span class="fl">0.1</span></a>
<a class="sourceLine" id="cb861-6" title="6"></a>
<a class="sourceLine" id="cb861-7" title="7"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>){</a>
<a class="sourceLine" id="cb861-8" title="8">    x &lt;-<span class="st"> </span><span class="kw">f</span>(x)</a>
<a class="sourceLine" id="cb861-9" title="9">}</a>
<a class="sourceLine" id="cb861-10" title="10"></a>
<a class="sourceLine" id="cb861-11" title="11"><span class="co"># Show x.</span></a>
<a class="sourceLine" id="cb861-12" title="12">x </a></code></pre></div>
<pre><code>## [1] 0.7390851</code></pre>
</div>
<div>
<p><strong>Python</strong></p>
<div class="sourceCode" id="cb863"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb863-1" title="1"><span class="co"># Importing the numpy module</span></a>
<a class="sourceLine" id="cb863-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb863-3" title="3"></a>
<a class="sourceLine" id="cb863-4" title="4"><span class="co"># Define our function f (cosine).</span></a>
<a class="sourceLine" id="cb863-5" title="5"><span class="kw">def</span> f(x):</a>
<a class="sourceLine" id="cb863-6" title="6">    <span class="cf">return</span> np.cos(x)</a>
<a class="sourceLine" id="cb863-7" title="7"></a>
<a class="sourceLine" id="cb863-8" title="8"><span class="co"># Define initial point x_0.</span></a>
<a class="sourceLine" id="cb863-9" title="9">x <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb863-10" title="10"></a>
<a class="sourceLine" id="cb863-11" title="11"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>): </a>
<a class="sourceLine" id="cb863-12" title="12">    x <span class="op">=</span> f(x)</a>
<a class="sourceLine" id="cb863-13" title="13"></a>
<a class="sourceLine" id="cb863-14" title="14"><span class="co"># Show x.</span></a>
<a class="sourceLine" id="cb863-15" title="15">x </a></code></pre></div>
<pre><code>## 0.7390851332151607</code></pre>
</div>
</div>
<p>We can check if <span class="math inline">\(x\)</span> is a fixed point by applying <span class="math inline">\(f\)</span> again.</p>
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); grid-column-gap: 10px;">
<div>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb865"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb865-1" title="1"><span class="kw">f</span>(x)</a></code></pre></div>
<pre><code>## [1] 0.7390851</code></pre>
</div>
<div>
<p><strong>Python</strong></p>
<div class="sourceCode" id="cb867"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb867-1" title="1">f(x)</a></code></pre></div>
<pre><code>## 0.7390851332151607</code></pre>
</div>
</div>
<p>We can see that the fixed operation converged to a fixed point. Note that here we fixed the number of iterations; we might be computing too many! We can inspect the convergence visually by plotting the values of <span class="math inline">\(x_n\)</span>.</p>
<p><img src="images/unnamed-chunk-291-1.png" width="50%" /></p>
<p>The values of <span class="math inline">\(x_n\)</span> oscillate up and down for the first few iterates, but after about 25 iterations the sequence is close to the fixed point.</p>
<p><strong>Exercise</strong>: Use the previous example to implement the fixed point iteration for
<span class="math display">\[
f(x) = \frac{1}{2}\left(\frac{2}{x}+x\right).
\]</span>
Plot the first 25 iterates.</p>
</div>
</div>
<div id="convergence-1" class="section level2 hasAnchor">
<h2><span class="header-section-number">7.2</span> Convergence<a href="roots.html#convergence-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="initial-point-and-convergence-1" class="section level3 hasAnchor">
<h3><span class="header-section-number">7.2.1</span> Initial point and convergence<a href="roots.html#initial-point-and-convergence-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The fixed point iteration <span class="math inline">\(x_n\)</span> may not converge. The sequence is characterised
by the function <span class="math inline">\(f\)</span> and the initial point <span class="math inline">\(x_0\)</span>. Both impact the convergence of
the sequence. Some functions <span class="math inline">\(f\)</span> do not have a fixed point, for example <span class="math inline">\(f(x) = e^x\)</span>. Other functions have a fixed point, but the convergence of the fixed
point iteration depends on the initial point <span class="math inline">\(x_0\)</span>, for example <span class="math inline">\(f(x) = 2x\)</span>.</p>
<p>Let’s look at another example. Consider
<span class="math display">\[
f(x) = x^2.
\]</span></p>
<p>The following plot depicts the first ten fixed point iterations with the initial value <span class="math inline">\(x_0 = 0.2\)</span></p>
<p><img src="images/unnamed-chunk-292-1.png" width="50%" /></p>
<p>And here is the fixed point iteration for the same function, now using <span class="math inline">\(x_0 = 1.2\)</span>.</p>
<p><img src="images/unnamed-chunk-293-1.png" width="50%" /></p>
<p>Note the <span class="math inline">\(y\)</span>-axis scale in the last plot! With <span class="math inline">\(x_0=1.2\)</span>, at the tenth iterate the value is above <span class="math inline">\(10^{40}\)</span>. In contrast, with <span class="math inline">\(x_0=0.2\)</span> the fixed iteration converges quickly to zero.</p>
<p><strong>Exercise:</strong> What is the exact expression of the <span class="math inline">\(n-th\)</span> fixed point iteration of f(x) = x^2$? Can you come up with a criterion to decide when will the sequence converge, depending on <span class="math inline">\(x_0\)</span>?</p>
</div>
<div id="convergence-criterion-1" class="section level3 hasAnchor">
<h3><span class="header-section-number">7.2.2</span> Convergence criterion<a href="roots.html#convergence-criterion-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Computing a fixed number of iterations is not a good strategy. We have seen in the examples above that sometimes the sequence converges in just a few iterates. In consequence, computing further iterations does not provide a better estimate of the fixed point. Ideally, we would like to stop the iteration when we are <em>close</em> to the fixed point. We could fixed a threshold <span class="math inline">\(\varepsilon &gt; 0\)</span>, and stop the iteration when we are closer than <span class="math inline">\(\varepsilon\)</span> to the fixed point,
<span class="math display">\[
| x_n - x^* | &lt; \varepsilon.
\]</span></p>
<p>However, we cannot implement this criterion. Remember, the aim of the fixed
point iteration is to estimate the fixed point <span class="math inline">\(x^*\)</span>. But to implement this
criterion, we need to know <span class="math inline">\(x^*\)</span> in advance. But if we already have <span class="math inline">\(x^*\)</span>, we
do not need to do any iteration!</p>
<p>For real functions, we can use the Cauchy completeness of the real numbers to
implement an alternative convergence criteria. Remember that in the real
numbers, a sequence is convergent if and only if the sequence is Cauchy, that
is, if terms of the sequence become arbitrarily close to each other as the
sequence progresses. In particular, if a sequence is convergent, consecutive
terms become close.</p>
<p><strong>Note</strong>: to be rigorous, a sequence can have <em>consecutive</em> terms becoming
arbitrarily close and yet not converge (e.g. $a_n=). This means that
checking consecutive terms provides a necessary but not sufficient condition.
However, it works well in practice.</p>
<p>Let’s see how to implement this in practice. Now that we have a criterion to stop the iteration, we can use a while loop instead of a for loop.</p>
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); grid-column-gap: 10px;">
<div>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb869"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb869-1" title="1"><span class="co"># Define our function f (cosine).</span></a>
<a class="sourceLine" id="cb869-2" title="2">f &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">cos</span>(x)</a>
<a class="sourceLine" id="cb869-3" title="3"></a>
<a class="sourceLine" id="cb869-4" title="4"><span class="co"># Our threshold for stopping.</span></a>
<a class="sourceLine" id="cb869-5" title="5">eps &lt;-<span class="st"> </span><span class="dv">1</span>.e<span class="dv">-8</span></a>
<a class="sourceLine" id="cb869-6" title="6"></a>
<a class="sourceLine" id="cb869-7" title="7"><span class="co"># Define initial point x_0.</span></a>
<a class="sourceLine" id="cb869-8" title="8">x &lt;-<span class="st"> </span><span class="fl">0.1</span></a>
<a class="sourceLine" id="cb869-9" title="9"></a>
<a class="sourceLine" id="cb869-10" title="10"><span class="co"># Compute the first iterate, </span></a>
<a class="sourceLine" id="cb869-11" title="11"><span class="co"># so we can evaluate the stopping criterion.</span></a>
<a class="sourceLine" id="cb869-12" title="12">x1 &lt;-<span class="st"> </span><span class="kw">f</span>(x) </a>
<a class="sourceLine" id="cb869-13" title="13"></a>
<a class="sourceLine" id="cb869-14" title="14"><span class="cf">while</span>(<span class="kw">abs</span>(x<span class="op">-</span>x1) <span class="op">&gt;</span><span class="st"> </span>eps){</a>
<a class="sourceLine" id="cb869-15" title="15">   x &lt;-<span class="st"> </span>x1 <span class="co">#Replace x by the next iteration x1. </span></a>
<a class="sourceLine" id="cb869-16" title="16">   x1 &lt;-<span class="st"> </span><span class="kw">f</span>(x) <span class="co">#Compute the next iteration</span></a>
<a class="sourceLine" id="cb869-17" title="17">}</a>
<a class="sourceLine" id="cb869-18" title="18"></a>
<a class="sourceLine" id="cb869-19" title="19"><span class="co"># Show x1. Note that the latest iteration is now x1.</span></a>
<a class="sourceLine" id="cb869-20" title="20">x1 </a></code></pre></div>
<pre><code>## [1] 0.7390851</code></pre>
</div>
<div>
<p><strong>Python</strong></p>
<div class="sourceCode" id="cb871"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb871-1" title="1"><span class="co"># Importing the numpy module</span></a>
<a class="sourceLine" id="cb871-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb871-3" title="3"></a>
<a class="sourceLine" id="cb871-4" title="4"><span class="co"># Define our function f (cosine).</span></a>
<a class="sourceLine" id="cb871-5" title="5"><span class="kw">def</span> f(x):</a>
<a class="sourceLine" id="cb871-6" title="6">    <span class="cf">return</span> np.cos(x)</a>
<a class="sourceLine" id="cb871-7" title="7"></a>
<a class="sourceLine" id="cb871-8" title="8"><span class="co"># Our threshold for stopping.</span></a>
<a class="sourceLine" id="cb871-9" title="9">eps <span class="op">=</span> <span class="dv">1</span>.e<span class="dv">-8</span></a>
<a class="sourceLine" id="cb871-10" title="10"></a>
<a class="sourceLine" id="cb871-11" title="11"><span class="co"># Define initial point x_0.</span></a>
<a class="sourceLine" id="cb871-12" title="12">x <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb871-13" title="13"></a>
<a class="sourceLine" id="cb871-14" title="14"><span class="co"># Compute the first iterate, </span></a>
<a class="sourceLine" id="cb871-15" title="15"><span class="co"># so we can evaluate the stopping criterion.</span></a>
<a class="sourceLine" id="cb871-16" title="16">x1 <span class="op">=</span> f(x) </a>
<a class="sourceLine" id="cb871-17" title="17"></a>
<a class="sourceLine" id="cb871-18" title="18"><span class="cf">while</span> <span class="bu">abs</span>(x<span class="op">-</span>x1) <span class="op">&gt;</span> eps:</a>
<a class="sourceLine" id="cb871-19" title="19">   x <span class="op">=</span> x1 <span class="co">#Replace x by the next iteration x1. </span></a>
<a class="sourceLine" id="cb871-20" title="20">   x1 <span class="op">=</span> f(x) <span class="co">#Compute the next iteration</span></a>
<a class="sourceLine" id="cb871-21" title="21"></a>
<a class="sourceLine" id="cb871-22" title="22"><span class="co"># Show x1</span></a>
<a class="sourceLine" id="cb871-23" title="23">x1 </a></code></pre></div>
<pre><code>## 0.7390851365828572</code></pre>
</div>
</div>
<p>Here, we have computed iterates until the distance between two consecutive iterations was less than <span class="math inline">\(\varepsilon=1-^{-8}\)</span>. However, this implementation is dangerous. What would happen if we apply it for an initial value or a function <span class="math inline">\(f\)</span> for which the fixed point iteration does not converge? It would never end!</p>
<p>When we implement stopping criteria, we need to ensure that the criteria will eventually be satisfied. For fixed point iterations, as for many other iterative schemes, the safest option is to limit the number of iterations. To do so, we can keep track of how many iterations we have performed in a variable <span class="math inline">\(it\)</span>, and stop the iteration if the number of iterations exceeds a given number. Look at the following implementation:</p>
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); grid-column-gap: 10px;">
<div>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb873"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb873-1" title="1"><span class="co"># Define our function f (cosine).</span></a>
<a class="sourceLine" id="cb873-2" title="2">f &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">cos</span>(x)</a>
<a class="sourceLine" id="cb873-3" title="3"></a>
<a class="sourceLine" id="cb873-4" title="4"><span class="co"># Our thresholds for stopping.</span></a>
<a class="sourceLine" id="cb873-5" title="5">eps &lt;-<span class="st"> </span><span class="dv">1</span>.e<span class="dv">-8</span></a>
<a class="sourceLine" id="cb873-6" title="6">itmax &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb873-7" title="7"></a>
<a class="sourceLine" id="cb873-8" title="8"><span class="co"># Define initial point x_0.</span></a>
<a class="sourceLine" id="cb873-9" title="9">x &lt;-<span class="st"> </span><span class="fl">0.1</span></a>
<a class="sourceLine" id="cb873-10" title="10"></a>
<a class="sourceLine" id="cb873-11" title="11"><span class="co"># Compute the first iterate, </span></a>
<a class="sourceLine" id="cb873-12" title="12"><span class="co"># so we can evaluate the stopping criterion.</span></a>
<a class="sourceLine" id="cb873-13" title="13">x1 &lt;-<span class="st"> </span><span class="kw">f</span>(x) </a>
<a class="sourceLine" id="cb873-14" title="14"></a>
<a class="sourceLine" id="cb873-15" title="15">it &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co"># Iteration counter</span></a>
<a class="sourceLine" id="cb873-16" title="16"></a>
<a class="sourceLine" id="cb873-17" title="17"><span class="cf">while</span>(<span class="kw">abs</span>(x<span class="op">-</span>x1) <span class="op">&gt;</span><span class="st"> </span>eps <span class="op">&amp;</span><span class="st"> </span>it <span class="op">&lt;</span><span class="st"> </span>itmax ){</a>
<a class="sourceLine" id="cb873-18" title="18">   x &lt;-<span class="st"> </span>x1 <span class="co">#Replace x by the next iteration x1. </span></a>
<a class="sourceLine" id="cb873-19" title="19">   x1 &lt;-<span class="st"> </span><span class="kw">f</span>(x) <span class="co">#Compute the next iteration</span></a>
<a class="sourceLine" id="cb873-20" title="20">   it &lt;-<span class="st"> </span>it <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="co">#Update counter</span></a>
<a class="sourceLine" id="cb873-21" title="21">}</a>
<a class="sourceLine" id="cb873-22" title="22"></a>
<a class="sourceLine" id="cb873-23" title="23"><span class="co">#Print number of iterations:</span></a>
<a class="sourceLine" id="cb873-24" title="24"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Iterations: &quot;</span>,it))</a></code></pre></div>
<pre><code>## [1] &quot;Iterations:  46&quot;</code></pre>
<div class="sourceCode" id="cb875"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb875-1" title="1"><span class="co"># Show x1. Note that the latest iteration is now x1.</span></a>
<a class="sourceLine" id="cb875-2" title="2">x1 </a></code></pre></div>
<pre><code>## [1] 0.7390851</code></pre>
</div>
<div>
<p><strong>Python</strong></p>
<div class="sourceCode" id="cb877"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb877-1" title="1"><span class="co"># Importing the numpy module</span></a>
<a class="sourceLine" id="cb877-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb877-3" title="3"></a>
<a class="sourceLine" id="cb877-4" title="4"><span class="co"># Define our function f (cosine).</span></a>
<a class="sourceLine" id="cb877-5" title="5"><span class="kw">def</span> f(x):</a>
<a class="sourceLine" id="cb877-6" title="6">    <span class="cf">return</span> np.cos(x)</a>
<a class="sourceLine" id="cb877-7" title="7"></a>
<a class="sourceLine" id="cb877-8" title="8"><span class="co"># Our threshold for stopping.</span></a>
<a class="sourceLine" id="cb877-9" title="9">eps <span class="op">=</span> <span class="dv">1</span>.e<span class="dv">-8</span></a>
<a class="sourceLine" id="cb877-10" title="10">itmax <span class="op">=</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb877-11" title="11"></a>
<a class="sourceLine" id="cb877-12" title="12"><span class="co"># Define initial point x_0.</span></a>
<a class="sourceLine" id="cb877-13" title="13">x <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb877-14" title="14"></a>
<a class="sourceLine" id="cb877-15" title="15"><span class="co"># Compute the first iterate, </span></a>
<a class="sourceLine" id="cb877-16" title="16"><span class="co"># so we can evaluate the stopping criterion.</span></a>
<a class="sourceLine" id="cb877-17" title="17">x1 <span class="op">=</span> f(x) </a>
<a class="sourceLine" id="cb877-18" title="18"></a>
<a class="sourceLine" id="cb877-19" title="19">it <span class="op">=</span> <span class="dv">0</span> <span class="co"># Iteration counter</span></a>
<a class="sourceLine" id="cb877-20" title="20"></a>
<a class="sourceLine" id="cb877-21" title="21"><span class="cf">while</span> <span class="bu">abs</span>(x<span class="op">-</span>x1) <span class="op">&gt;</span> eps <span class="kw">and</span> it <span class="op">&lt;</span> itmax:</a>
<a class="sourceLine" id="cb877-22" title="22">   x <span class="op">=</span> x1 <span class="co">#Replace x by the next iteration x1. </span></a>
<a class="sourceLine" id="cb877-23" title="23">   x1 <span class="op">=</span> f(x) <span class="co">#Compute the next iteration</span></a>
<a class="sourceLine" id="cb877-24" title="24">   it <span class="op">=</span> it <span class="op">+</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb877-25" title="25"></a>
<a class="sourceLine" id="cb877-26" title="26"><span class="bu">print</span>(<span class="st">&quot;Iterations: </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(it))</a></code></pre></div>
<pre><code>## Iterations: 46</code></pre>
<div class="sourceCode" id="cb879"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb879-1" title="1"><span class="co"># Show x1</span></a>
<a class="sourceLine" id="cb879-2" title="2">x1 </a></code></pre></div>
<pre><code>## 0.7390851365828572</code></pre>
</div>
</div>
<p>We can see that it takes 46 iterations to satisfy the stopping criteria. Since we set the maximum iterations <code>itmax</code> at 100, this means that the distance between consecutive iterates is smaller than <code>eps</code>.</p>
</div>
</div>
<div id="fixed-point-theorems-1" class="section level2 hasAnchor">
<h2><span class="header-section-number">7.3</span> Fixed point theorems<a href="roots.html#fixed-point-theorems-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section cover some theory about fixed points.</p>
<p>We have seen how to implement the fixed point iteration, and how to implement stopping criteria to ensure our algorithm does not run forever. However, we know that for some functions, and depending on the initial point <span class="math inline">\(x_0\)</span>, our fixed point iteration will not converge. Would not it be nice to have some results to figure out when the sequence <em>actually</em> converges? And even better, to know how long it will take to converge?</p>
<p>Fixed point theorems are results about the existence and uniqueness of fixed points. There are many fixed point theorems, depending on the assumptions we make on the function <span class="math inline">\(f\)</span>. The general form of a fixed point theorem is as follows:</p>
<p><strong>“Theorem”:</strong> Let <span class="math inline">\(f:X \to X\)</span> be a function satisfying . Then, there exists <span class="math inline">\(x^*\in X\)</span> such that <span class="math inline">\(f(x^*)=x^*\)</span>.</p>
<p>Here <span class="math inline">\(X\)</span> can be many different types of spaces, and the properties required to ensure the existence of a fixed point will relate to the type of space. For example, in topology we have the Brouwer fixed point theorem (continous function on compact convex sets); in algebra we have Kleene fixed point theorem (order preserving functions on a complete lattice); in analysis, we have the Banach fixed point theorem (contraction mappings on a metric space).</p>
<p>Here, we will discuss briefly a version of Brouwer and Banach fixed point theorems for real functions.</p>
<div id="existence-of-fixed-points-1" class="section level3 hasAnchor">
<h3><span class="header-section-number">7.3.1</span> Existence of fixed points<a href="roots.html#existence-of-fixed-points-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For real funcions, we can state a simple existence result.</p>
<p><strong>Proposition:</strong> Let <span class="math inline">\(f:[a,b] \to [a,b]\)</span> continuous, then <span class="math inline">\(f(x)=x\)</span> has at least one solution on <span class="math inline">\([a,b]\)</span>.</p>
<p><strong>Exercise:</strong> Use the intermediate value theorem to prove the proposition. <strong>Hint:</strong> Define <span class="math inline">\(g(x) = f(x) - x\)</span>.</p>
</div>
<div id="uniqueness-of-fixed-points-1" class="section level3 hasAnchor">
<h3><span class="header-section-number">7.3.2</span> Uniqueness of fixed points<a href="roots.html#uniqueness-of-fixed-points-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The previous proposition ensures that a fixed point exists, but often we are also interested in knowing that the fixed point is <em>unique</em>. We will use another results that you might know from MATH113, the contraction mapping theorem.</p>
<p>First, a couple of definitions.</p>
<p><strong>Definition (Lipschitz function)</strong>: A function <span class="math inline">\(f:[a,b] \to \mathbb{R}\)</span> is called a <em>Lipschitz function</em> if there exists some <span class="math inline">\(k \in [0,\infty)\)</span> such that, for all <span class="math inline">\(x,y \in [a,b]\)</span>,
<span class="math display">\[\begin{equation}
|f(x)-f(y)| \leq k|x-y|.
\end{equation}\]</span>
We call <span class="math inline">\(k\)</span> a <em>Lipschitz constant</em>.</p>
<p><strong>Definition (contraction mapping)</strong>: A contraction mapping is a Lipschitz function <span class="math inline">\(f:[a,b] \to [a,b]\)</span> with Lipschitz constant <span class="math inline">\(k&lt;1\)</span>.
Note that all Lipschitz functions are continous (<strong>why?</strong>), but the reverse is
generally not true. However, as a continous function from <span class="math inline">\([a,b]\)</span> to itself, we
already know that the function has (at least) one fixed point.</p>
<div id="checking-if-a-function-is-a-contraction-mapping-1" class="section level4 hasAnchor">
<h4><span class="header-section-number">7.3.2.1</span> Checking if a function is a contraction mapping<a href="roots.html#checking-if-a-function-is-a-contraction-mapping-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Computing the Lipschitz constant is difficult if we do not impose further restrictions. If we ask <em>a little more</em> about <span class="math inline">\(f\)</span>, namely that <span class="math inline">\(f\)</span> is differentiable, then we can use the mean value theorem to find a Lipschitz constant of <span class="math inline">\(f\)</span>. More precisely, assume that <span class="math inline">\(f\)</span> is differentiable and <span class="math inline">\(f&#39;(x)\)</span> is bounded in <span class="math inline">\([a,b]\)</span> (that is, there exists <span class="math inline">\(\rho\in\mathbb{R}^+\)</span> such that for all <span class="math inline">\(x\in [a,b]\)</span> <span class="math inline">\(|f&#39;(x)| \leq \rho\)</span>). Then, by the mean value theorem, for every <span class="math inline">\(x,y \in [a,b], x&lt;y\)</span>, there exists some <span class="math inline">\(c \in [x,y]\)</span> such that
<span class="math display">\[
|f(x)-f(y)| = |f&#39;(c)||x-y|,
\]</span>
and using the bound on <span class="math inline">\(f&#39;\)</span>, we have
<span class="math display">\[
|f(x)-f(y)| = |f&#39;(c)||x-y| \leq \rho |x-y|.
\]</span>
Therefore <span class="math inline">\(\rho\)</span> is a Lipschitz constant for <span class="math inline">\(f\)</span>.</p>
<p>To check if a function is a contraction mapping, it is enough to show that its derivative is bounded by <span class="math inline">\(\rho &lt; 1\)</span>.</p>
<p>We can now state the contraction mapping theorem.</p>
<p><strong>Theorem (contraction mapping):</strong> Let <span class="math inline">\(f:[a,b] \to [a,b]\)</span> be a contraction mapping with Lipschitz constant <span class="math inline">\(k\)</span>. Then there is exactly one fixed point, <span class="math inline">\(x^*\)</span>, of <span class="math inline">\(f\)</span> on the interval <span class="math inline">\([a,b]\)</span>. Furthermore, for any <span class="math inline">\(x_0\in [a,b]\)</span> the fixed point iteration <span class="math inline">\(x_{n+1} = f(x_{n})\)</span>, <span class="math inline">\(n=1,2,\dots\)</span>, satisfies
<span class="math display">\[\begin{equation}
|x^* -x_n| \leq |b-a| k^n.
\end{equation}\]</span></p>
<p><strong>Exercise:</strong> Prove the contraction mapping theorem. <strong>Hints:</strong> to prove uniqueness, assume there are two fixed points and apply the definition of contraction mapping; to prove the inequality, note that <span class="math inline">\(|x^* - x_n| = |f(x^*) - f(x_{n-1})|\)</span>, and apply the definition of Lipschitz function.</p>
<p>Note that this theorem gives as more than uniqueness: it tells us how close we are to the fixed point, even if we do not know the fixed point! We can use this result to estimate how many iterations are needed to achieve a desired approximation.</p>
<p><strong>Example:</strong> Consider the function <span class="math inline">\(f:[0,1/3]\rightarrow [0,1/3]\)</span>, <span class="math inline">\(f(x) = x^2\)</span>. We note that <span class="math inline">\(f\)</span> is a contraction mapping, since <span class="math inline">\(|f&#39;(x)| = |2x| \leq 2/3 &lt; 1\)</span> for <span class="math inline">\(x \in [0,1/3]\)</span>. A Lipschitz constant for for <span class="math inline">\(f\)</span> is <span class="math inline">\(k = 2/3\)</span>. The contraction mapping theorem tells as that there is a unique fixed point, and that
<span class="math display">\[
|x^* - x_n| \leq \frac{1}{3} \left(\frac{2}{3}\right)^n.
\]</span>
Let’s assume that we are interested in finding the fixed point with an error less than <span class="math inline">\(\varepsilon\)</span>. We can impose
<span class="math display">\[
\frac{1}{3} \left(\frac{2}{3}\right)^n \leq \varepsilon,
\]</span>
and find
<span class="math display">\[
n \geq \frac{\log(\varepsilon) - \log(1/3)}{\log(2/3)}.
\]</span></p>
<p>Note that we can do this in general:
<span class="math display">\[
n \geq \frac{\log(\varepsilon) - \log(|b-a|)}{\log(k)}.
\]</span></p>
<p>Let’s apply this result to run the fixed point iteration for this function using a <em>for</em> loop.</p>
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); grid-column-gap: 10px;">
<div>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb881"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb881-1" title="1"><span class="co"># Define our function f (cosine).</span></a>
<a class="sourceLine" id="cb881-2" title="2">f &lt;-<span class="st"> </span>\(x) x<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb881-3" title="3"></a>
<a class="sourceLine" id="cb881-4" title="4"><span class="co"># Define initial point x_0.</span></a>
<a class="sourceLine" id="cb881-5" title="5">x &lt;-<span class="st"> </span><span class="fl">0.1</span></a>
<a class="sourceLine" id="cb881-6" title="6"></a>
<a class="sourceLine" id="cb881-7" title="7"><span class="co"># Fixed desired error</span></a>
<a class="sourceLine" id="cb881-8" title="8">eps &lt;-<span class="st"> </span><span class="dv">1</span>.e<span class="dv">-1</span></a>
<a class="sourceLine" id="cb881-9" title="9"></a>
<a class="sourceLine" id="cb881-10" title="10"><span class="co"># Compute number of iterations (next integer)</span></a>
<a class="sourceLine" id="cb881-11" title="11">N &lt;-<span class="st"> </span><span class="kw">ceiling</span>((<span class="kw">log</span>(eps) <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>))<span class="op">/</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">/</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb881-12" title="12"></a>
<a class="sourceLine" id="cb881-13" title="13"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb881-14" title="14">    x &lt;-<span class="st"> </span><span class="kw">f</span>(x)</a>
<a class="sourceLine" id="cb881-15" title="15">}</a>
<a class="sourceLine" id="cb881-16" title="16"></a>
<a class="sourceLine" id="cb881-17" title="17"><span class="co"># Show x.</span></a>
<a class="sourceLine" id="cb881-18" title="18">x </a></code></pre></div>
<pre><code>## [1] 1e-08</code></pre>
</div>
<div>
<p><strong>Python</strong></p>
<div class="sourceCode" id="cb883"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb883-1" title="1"><span class="co"># Importing the numpy module</span></a>
<a class="sourceLine" id="cb883-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb883-3" title="3"></a>
<a class="sourceLine" id="cb883-4" title="4"><span class="co"># Define our function f</span></a>
<a class="sourceLine" id="cb883-5" title="5">f <span class="op">=</span> <span class="kw">lambda</span> x: x<span class="op">**</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb883-6" title="6"></a>
<a class="sourceLine" id="cb883-7" title="7"><span class="co"># Define initial point x_0.</span></a>
<a class="sourceLine" id="cb883-8" title="8">x <span class="op">=</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb883-9" title="9"></a>
<a class="sourceLine" id="cb883-10" title="10"><span class="co"># Fixed desired error</span></a>
<a class="sourceLine" id="cb883-11" title="11">eps <span class="op">=</span> <span class="dv">1</span>.e<span class="dv">-1</span></a>
<a class="sourceLine" id="cb883-12" title="12"></a>
<a class="sourceLine" id="cb883-13" title="13"><span class="co"># Compute number of iterations (next integer)</span></a>
<a class="sourceLine" id="cb883-14" title="14">N <span class="op">=</span> <span class="bu">int</span>(np.ceil((np.log(eps) <span class="op">-</span> np.log(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>))<span class="op">/</span>np.log(<span class="dv">2</span><span class="op">/</span><span class="dv">3</span>)))</a>
<a class="sourceLine" id="cb883-15" title="15"></a>
<a class="sourceLine" id="cb883-16" title="16"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N): </a>
<a class="sourceLine" id="cb883-17" title="17">    x <span class="op">=</span> f(x)</a>
<a class="sourceLine" id="cb883-18" title="18"></a>
<a class="sourceLine" id="cb883-19" title="19"><span class="co"># Show x.</span></a>
<a class="sourceLine" id="cb883-20" title="20">x </a></code></pre></div>
<pre><code>## 1.0000000000000008e-08</code></pre>
</div>
</div>
<p>In this case, we know that the exact value of the fixed point is <span class="math inline">\(x^* = 0\)</span>. We can see that after <code>N</code> iterations, the value of <span class="math inline">\(x_N\)</span> is less than <code>eps</code> as expected. Note that the estimate for <span class="math inline">\(N\)</span> was far to large, we are getting a much lower error that what is ensured by the error bound. However, the error also depends on the initial point <span class="math inline">\(x_0\)</span>. Try running the iteration with <span class="math inline">\(x_0 = 1/3\)</span>, for example.</p>
</div>
</div>
</div>
<div id="exercises-1" class="section level2 hasAnchor">
<h2><span class="header-section-number">7.4</span> Exercises<a href="roots.html#exercises-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Exercise:</strong> We have seen how to implement a stopping criterion based on the
<em>absolute</em> difference between consecutive iterates. Sometimes, if a function
takes large values, that criterion may take too long to be satisfied. Implement
another stopping criterion based on the <em>relative</em> difference, <span class="math inline">\(|(x_{n+1} - x_n)/x_n| &lt; \varepsilon_r\)</span>. Implement it together with the absolute value
criterion, and the bound on the maximum number of iterations.</p>
<p><strong>Exercise:</strong> Implement a function <code>recursive_fixed_point</code> that takes a
function <code>f</code>, a point <code>x</code> and an absolute tolerance <code>eps</code>, and runs the fixed
point iteration recursively (that is, calling <code>recursive_fixed_point</code> itself
within the function). You should not use any <em>for</em> or <em>while</em> loops.</p>
<p><strong>Challenge:</strong> Implement a function <code>recursive_fixed_point</code> that takes a
function <code>f</code>, a point <code>x</code> and an absolute tolerance <code>eps</code>, a relative tolerance
<code>eps_r</code> and a maximum number of iterates <code>itmax</code> and runs the fixed point
iteration recursively (that is, calling <code>recursive_fixed_point</code> itself within
the function). You should not use any <em>for</em> or <em>while</em> loops. The function
should return <code>NA</code> or <code>np.nan</code> if the maximum number of iterations is reached.</p>
<p><strong>Exercise:</strong> Apply the contraction mapping theorem to <span class="math inline">\(f:[0,1]\rightarrow [0,1]\)</span>, <span class="math inline">\(f(x) = cos(x)\)</span>. Implement the fixed point iteration using the absolute
error criterion. Run the fixed point iteration for 100 equispaced points in
[0,1], and compare the number of iterations with the number of iterations given
by the contraction mapping theorem.</p>
<style type="text/css">
.book .book-body .page-wrapper .page-inner {
  max-width: 1200px !important;
}
</style>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="fixed.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="challenge.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
